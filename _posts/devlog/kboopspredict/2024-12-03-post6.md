---
layout: post
title: "KBO 타자 OPS 예측 경진대회 - 5"
subtitle: "Hydejack Post Writing Tips & Tricks"
category: devlog
tags: kboopspredict
---

```python
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib
import matplotlib.font_manager as fm
import os
from IPython.display import HTML
import seaborn as sns
from IPython.display import display
import numpy as np
import re
import json


pd.options.display.max_columns = None
%matplotlib inline

# 한글 폰트
plt.rcParams['font.family'] = 'NanumGothic'
# 마이너스 깨짐 방지
matplotlib.rcParams['axes.unicode_minus'] = False

# 나눔 폰트 경로 설정
font_path = '/usr/share/fonts/truetype/nanum/NanumGothic.ttf'  # 나눔 고딕의 경로
font_prop = fm.FontProperties(fname=font_path).get_name()

# 한글 폰트 설정
matplotlib.rcParams['font.family'] = font_prop
```


```python
os.listdir('./datas')
```




    ['Pre_Season_Batter.csv',
     'Regular_Season_Batter.csv',
     'submission.csv',
     'Regular_Season_Batter_Day_by_Day_b4.csv']



## 데이터 살펴보기


```python
pd.read_csv('./datas/Regular_Season_Batter_Day_by_Day_b4.csv').head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>date</th>
      <th>opposing_team</th>
      <th>avg1</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>avg2</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>3.24</td>
      <td>NC</td>
      <td>0.333</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.333</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>가르시아</td>
      <td>3.25</td>
      <td>NC</td>
      <td>0.000</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.143</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>가르시아</td>
      <td>3.27</td>
      <td>넥센</td>
      <td>0.200</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.167</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>가르시아</td>
      <td>3.28</td>
      <td>넥센</td>
      <td>0.200</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.176</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>가르시아</td>
      <td>3.29</td>
      <td>넥센</td>
      <td>0.250</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.190</td>
      <td>2018</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.read_csv('./datas/Pre_Season_Batter.csv').head(1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>2018</td>
      <td>LG</td>
      <td>0.350</td>
      <td>7</td>
      <td>20</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.55</td>
      <td>0.409</td>
      <td>1</td>
      <td>177cm/93kg</td>
      <td>1985년 04월 12일</td>
      <td>내야수(우투우타)</td>
      <td>쿠바 Ciego de Avila Maximo Gomez Baez(대)</td>
      <td>NaN</td>
      <td>0.959</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.read_csv('./datas/Regular_Season_Batter.csv').head(1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>2018</td>
      <td>LG</td>
      <td>0.339</td>
      <td>50</td>
      <td>183</td>
      <td>27</td>
      <td>62</td>
      <td>9</td>
      <td>0</td>
      <td>8</td>
      <td>95</td>
      <td>34</td>
      <td>5</td>
      <td>0</td>
      <td>9</td>
      <td>8</td>
      <td>25</td>
      <td>3</td>
      <td>0.519</td>
      <td>0.383</td>
      <td>9</td>
      <td>177cm/93kg</td>
      <td>1985년 04월 12일</td>
      <td>내야수(우투우타)</td>
      <td>쿠바 Ciego de Avila Maximo Gomez Baez(대)</td>
      <td>NaN</td>
      <td>0.902</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.read_csv('./datas/submission.csv').head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>강경학</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>강구성</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>강민국</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>강민호</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>강백호</td>
    </tr>
  </tbody>
</table>
</div>



## 프리시즌 데이터 확인


```python
preseason = pd.read_csv('./datas/Pre_Season_Batter.csv')
print(preseason.shape)
print()
print(preseason.info())
preseason.head()
```

    (1393, 29)
    
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1393 entries, 0 to 1392
    Data columns (total 29 columns):
     #   Column           Non-Null Count  Dtype  
    ---  ------           --------------  -----  
     0   batter_id        1393 non-null   int64  
     1   batter_name      1393 non-null   object 
     2   year             1393 non-null   int64  
     3   team             1393 non-null   object 
     4   avg              1393 non-null   object 
     5   G                1393 non-null   int64  
     6   AB               1393 non-null   int64  
     7   R                1393 non-null   int64  
     8   H                1393 non-null   int64  
     9   2B               1393 non-null   int64  
     10  3B               1393 non-null   int64  
     11  HR               1393 non-null   int64  
     12  TB               1393 non-null   int64  
     13  RBI              1393 non-null   int64  
     14  SB               1393 non-null   int64  
     15  CS               1393 non-null   int64  
     16  BB               1393 non-null   int64  
     17  HBP              1393 non-null   int64  
     18  SO               1393 non-null   int64  
     19  GDP              1393 non-null   int64  
     20  SLG              1364 non-null   float64
     21  OBP              1368 non-null   float64
     22  E                1393 non-null   int64  
     23  height/weight    1393 non-null   object 
     24  year_born        1393 non-null   object 
     25  position         1393 non-null   object 
     26  career           1393 non-null   object 
     27  starting_salary  1179 non-null   object 
     28  OPS              1364 non-null   float64
    dtypes: float64(3), int64(18), object(8)
    memory usage: 315.7+ KB
    None





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>2018</td>
      <td>LG</td>
      <td>0.350</td>
      <td>7</td>
      <td>20</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.550</td>
      <td>0.409</td>
      <td>1</td>
      <td>177cm/93kg</td>
      <td>1985년 04월 12일</td>
      <td>내야수(우투우타)</td>
      <td>쿠바 Ciego de Avila Maximo Gomez Baez(대)</td>
      <td>NaN</td>
      <td>0.959</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>강경학</td>
      <td>2011</td>
      <td>한화</td>
      <td>0.000</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.500</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>강경학</td>
      <td>2014</td>
      <td>한화</td>
      <td>-</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>강경학</td>
      <td>2015</td>
      <td>한화</td>
      <td>0.130</td>
      <td>10</td>
      <td>23</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>0.130</td>
      <td>0.286</td>
      <td>2</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>강경학</td>
      <td>2016</td>
      <td>한화</td>
      <td>0.188</td>
      <td>14</td>
      <td>32</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
      <td>0.281</td>
      <td>0.212</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.493</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 데이터 기초 통계량

'''
1. 선수는 총 1393명이 있다.
2. 데이터는 2002년부터 2018년까지 존재한다.
'''

preseason.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>year</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1393.000000</td>
      <td>1364.000000</td>
      <td>1368.000000</td>
      <td>1393.000000</td>
      <td>1364.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>173.434314</td>
      <td>2013.014358</td>
      <td>8.705671</td>
      <td>19.201723</td>
      <td>2.679828</td>
      <td>5.021536</td>
      <td>0.954774</td>
      <td>0.119885</td>
      <td>0.391960</td>
      <td>7.391960</td>
      <td>2.430725</td>
      <td>0.629576</td>
      <td>0.291457</td>
      <td>1.877961</td>
      <td>0.330223</td>
      <td>3.714286</td>
      <td>0.447236</td>
      <td>0.361012</td>
      <td>0.317912</td>
      <td>0.381910</td>
      <td>0.676924</td>
    </tr>
    <tr>
      <th>std</th>
      <td>94.716851</td>
      <td>4.166757</td>
      <td>5.562686</td>
      <td>13.395946</td>
      <td>2.637212</td>
      <td>4.232584</td>
      <td>1.196904</td>
      <td>0.379976</td>
      <td>0.748557</td>
      <td>6.538787</td>
      <td>2.698122</td>
      <td>1.146854</td>
      <td>0.595522</td>
      <td>2.053392</td>
      <td>0.642204</td>
      <td>3.180884</td>
      <td>0.723364</td>
      <td>0.269892</td>
      <td>0.151489</td>
      <td>0.729521</td>
      <td>0.386933</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>2002.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>99.000000</td>
      <td>2010.000000</td>
      <td>6.000000</td>
      <td>9.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.217000</td>
      <td>0.250000</td>
      <td>0.000000</td>
      <td>0.472000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>178.000000</td>
      <td>2014.000000</td>
      <td>9.000000</td>
      <td>18.000000</td>
      <td>2.000000</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>0.344500</td>
      <td>0.333000</td>
      <td>0.000000</td>
      <td>0.675000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>254.000000</td>
      <td>2017.000000</td>
      <td>11.000000</td>
      <td>28.000000</td>
      <td>4.000000</td>
      <td>8.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>11.000000</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>5.000000</td>
      <td>1.000000</td>
      <td>0.478000</td>
      <td>0.400000</td>
      <td>1.000000</td>
      <td>0.867000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>344.000000</td>
      <td>2018.000000</td>
      <td>119.000000</td>
      <td>183.000000</td>
      <td>35.000000</td>
      <td>51.000000</td>
      <td>11.000000</td>
      <td>4.000000</td>
      <td>5.000000</td>
      <td>68.000000</td>
      <td>24.000000</td>
      <td>9.000000</td>
      <td>4.000000</td>
      <td>21.000000</td>
      <td>4.000000</td>
      <td>36.000000</td>
      <td>5.000000</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
'''
프리시즌은 연습경기이기 때문에 많은 데이터가 0쪽에 가깝다.
예를 들어 1년에 일반적인 정규타석을 채우지 않았고, 득전, 타수, 안타 등이 0에 가깝다.
또한 데이터의 양은 과거보다 최근에 가까워 질수록 많아진다.
'''

preseason.hist(figsize=(20,9))
plt.tight_layout()
plt.show()
```


    
![png](/assets/img/main4_files/main4_10_0.png)
    



```python
'''
데이터의 개수가 적어서 그런가 대부분의 연도의 OPS의 중앙값이 비슷하다.
'''
plt.figure(figsize=(20,5))
sns.boxplot(x='year', y='OPS', data=preseason, showfliers=False)
```




    <Axes: xlabel='year', ylabel='OPS'>




    
![png](/assets/img/main4_files/main4_11_1.png)
    



```python
'''
몇 몇 선수들을 추출해 OPS를 비교해 보았다.

그러던 도중 결측값이 있는 것을 발견하였다.
'''

preseason_df_2002 = preseason[preseason['year'] == 2002]
preseason_df_2002
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>228</th>
      <td>62</td>
      <td>김주찬</td>
      <td>2002</td>
      <td>롯데</td>
      <td>0.107</td>
      <td>9</td>
      <td>28</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>0.107</td>
      <td>0.167</td>
      <td>1</td>
      <td>183cm/94kg</td>
      <td>1981년 03월 25일</td>
      <td>내야수(우투우타)</td>
      <td>충암초(장충리틀)-충암중-충암고-삼성-롯데</td>
      <td>18000만원</td>
      <td>0.274</td>
    </tr>
    <tr>
      <th>260</th>
      <td>67</td>
      <td>김태균</td>
      <td>2002</td>
      <td>한화</td>
      <td>0.235</td>
      <td>11</td>
      <td>34</td>
      <td>7</td>
      <td>8</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>16</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>14</td>
      <td>0</td>
      <td>0.471</td>
      <td>0.333</td>
      <td>2</td>
      <td>185cm/110kg</td>
      <td>1982년 05월 29일</td>
      <td>내야수(우투우타)</td>
      <td>천안남산초-천안북중-북일고-(대전대)</td>
      <td>16000만원</td>
      <td>0.804</td>
    </tr>
    <tr>
      <th>413</th>
      <td>109</td>
      <td>박기혁</td>
      <td>2002</td>
      <td>롯데</td>
      <td>0.000</td>
      <td>8</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>179cm/77kg</td>
      <td>1981년 06월 04일</td>
      <td>내야수(우투우타)</td>
      <td>대구수창초-성광중-대구상고-롯데</td>
      <td>8000만원</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>467</th>
      <td>119</td>
      <td>박용택</td>
      <td>2002</td>
      <td>LG</td>
      <td>-</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>185cm/90kg</td>
      <td>1979년 04월 21일</td>
      <td>외야수(우투좌타)</td>
      <td>고명초-휘문중-휘문고-고려대</td>
      <td>30000만원</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>511</th>
      <td>131</td>
      <td>박한이</td>
      <td>2002</td>
      <td>삼성</td>
      <td>0.319</td>
      <td>11</td>
      <td>47</td>
      <td>7</td>
      <td>15</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>21</td>
      <td>4</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>0.447</td>
      <td>0.360</td>
      <td>0</td>
      <td>182cm/91kg</td>
      <td>1979년 01월 28일</td>
      <td>외야수(좌투좌타)</td>
      <td>초량초-부산중-부산고-동국대</td>
      <td>30000만원</td>
      <td>0.807</td>
    </tr>
    <tr>
      <th>824</th>
      <td>202</td>
      <td>이대호</td>
      <td>2002</td>
      <td>롯데</td>
      <td>0.359</td>
      <td>11</td>
      <td>39</td>
      <td>4</td>
      <td>14</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>20</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>0.513</td>
      <td>0.375</td>
      <td>1</td>
      <td>194cm/130kg</td>
      <td>1982년 06월 21일</td>
      <td>내야수(우투우타)</td>
      <td>부산수영초-대동중-경남고-(영남사이버대)-롯데-시애틀</td>
      <td>21000만원</td>
      <td>0.888</td>
    </tr>
    <tr>
      <th>844</th>
      <td>207</td>
      <td>이범호</td>
      <td>2002</td>
      <td>한화</td>
      <td>0.167</td>
      <td>7</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.333</td>
      <td>0.167</td>
      <td>0</td>
      <td>183cm/96kg</td>
      <td>1981년 11월 25일</td>
      <td>내야수(우투우타)</td>
      <td>대구수창초-경운중-대구고-한화</td>
      <td>11000만원</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>892</th>
      <td>283</td>
      <td>조동찬</td>
      <td>2002</td>
      <td>삼성</td>
      <td>0.000</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>180cm/80kg</td>
      <td>1983년 07월 27일</td>
      <td>내야수(우투우타)</td>
      <td>공주중동초-공주중-공주고</td>
      <td>12000만원</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>984</th>
      <td>234</td>
      <td>이진영</td>
      <td>2002</td>
      <td>SK</td>
      <td>0.297</td>
      <td>11</td>
      <td>37</td>
      <td>5</td>
      <td>11</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>19</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>12</td>
      <td>0</td>
      <td>0.514</td>
      <td>0.381</td>
      <td>0</td>
      <td>185cm/90kg</td>
      <td>1980년 06월 15일</td>
      <td>외야수(좌투좌타)</td>
      <td>군산초-군산남중-군산상고-쌍방울-SK-LG</td>
      <td>10000만원</td>
      <td>0.895</td>
    </tr>
    <tr>
      <th>1115</th>
      <td>269</td>
      <td>정상호</td>
      <td>2002</td>
      <td>SK</td>
      <td>0.158</td>
      <td>13</td>
      <td>19</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>7</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>0.368</td>
      <td>0.304</td>
      <td>5</td>
      <td>187cm/100kg</td>
      <td>1982년 12월 24일</td>
      <td>포수(우투우타)</td>
      <td>석천초-동인천중-동산고-SK-상무-SK</td>
      <td>45000만원</td>
      <td>0.672</td>
    </tr>
    <tr>
      <th>1128</th>
      <td>270</td>
      <td>정성훈</td>
      <td>2002</td>
      <td>KIA</td>
      <td>0.267</td>
      <td>12</td>
      <td>30</td>
      <td>5</td>
      <td>8</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.400</td>
      <td>0.258</td>
      <td>0</td>
      <td>182cm/83kg</td>
      <td>1980년 06월 27일</td>
      <td>내야수(우투우타)</td>
      <td>송정동초-무등중-광주제일고-해태-KIA-현대-우리-LG</td>
      <td>15000만원</td>
      <td>0.658</td>
    </tr>
    <tr>
      <th>1327</th>
      <td>319</td>
      <td>최형우</td>
      <td>2002</td>
      <td>삼성</td>
      <td>0.000</td>
      <td>5</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.167</td>
      <td>0</td>
      <td>180cm/106kg</td>
      <td>1983년 12월 16일</td>
      <td>외야수(우투좌타)</td>
      <td>진북초-전주동중-전주고-삼성-경찰-삼성</td>
      <td>5000만원</td>
      <td>0.167</td>
    </tr>
  </tbody>
</table>
</div>



## 프리시즌 결측값 채우기


```python
'''
결측값의 개수를 확인해 보았다.
'''

for i, j in preseason.isnull().sum().items():
    if not j == 0:
        print(i, j)
        
'''
nan 값이 있는 행만 추출해 보았다.

그 중에서 starting_salary부분이 nan인 경우는 제외 하였다.
'''
preseason[preseason.isna().any(axis=1) & preseason['starting_salary'].notna()].head()
```

    SLG 29
    OBP 25
    starting_salary 214
    OPS 29





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>강경학</td>
      <td>2014</td>
      <td>한화</td>
      <td>-</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>37</th>
      <td>8</td>
      <td>강상원</td>
      <td>2016</td>
      <td>한화</td>
      <td>-</td>
      <td>6</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>172cm/64kg</td>
      <td>1997년 05월 05일</td>
      <td>외야수(우투좌타)</td>
      <td>온양온천초-온양중-북일고</td>
      <td>3000만원</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>74</th>
      <td>24</td>
      <td>김강민</td>
      <td>2003</td>
      <td>SK</td>
      <td>-</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>182cm/85kg</td>
      <td>1982년 09월 13일</td>
      <td>외야수(우투우타)</td>
      <td>본리초-대구중-경북고</td>
      <td>11000만원</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>80</th>
      <td>24</td>
      <td>김강민</td>
      <td>2009</td>
      <td>SK</td>
      <td>-</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>182cm/85kg</td>
      <td>1982년 09월 13일</td>
      <td>외야수(우투우타)</td>
      <td>본리초-대구중-경북고</td>
      <td>11000만원</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>90</th>
      <td>101</td>
      <td>문선재</td>
      <td>2009</td>
      <td>LG</td>
      <td>-</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>0</td>
      <td>184cm/80kg</td>
      <td>1990년 05월 20일</td>
      <td>외야수(우투우타)</td>
      <td>광주서림초-광주동성중-광주동성고-LG-상무</td>
      <td>5000만원</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
'''
장타율과 출루율이 계산되지 않아 OPS가 NaN이 나온것을 확인 하였다.
검색해 보니 장타율 같은 경우에는 (3루타 + 2루타 + 홈런) / 안타 로 계산하는데 이것은 TBS식 장타율이라고 한다.
다른 데이터와 비교하여 TBS식 장타율로 계산되었으면 이것도 같은 방법으로 계산하여 채우려고 한다.
'''

# 3루타, 2루타, 홈런, 안타를 추출하여 계산
print(f'clac_SLG: {preseason.loc[0, ["3B", "2B", "HR"]].sum() / preseason.loc[0, ["H"]]}')
print(f'orig_SLG: {preseason.loc[0, "SLG"]}')
print()

'''
계산해 보니 다르다.
알고보니 이것은 일본 TBS 테레비의 루즈밸트 게임 드라마에서 나온 잘못된 계산식이라고 한다.

조금 더 찾아보니 다른 식을 찾을 수 있었다.
(1루타(단타) x 1 + 2루타 x 2 + 3루타 x 3 + 홈런 x 4) / 타수
'''

# 안타, 2루타, 3루타, 홈런을 추출하여 각각 1, 2, 3, 4씩 곱하고 이후 타수만큼 나눈다.
cnt = 1
SLG = 0
for i in preseason.loc[0, ['H', '2B', '3B', 'HR']]:
    SLG += i * cnt
    cnt += 1

SLG = SLG / preseason.loc[0, "AB"]
print(f'clac_SLG: {SLG}')
print(f'orig_SLG: {preseason.loc[0, "SLG"]}')
print()

'''
약 0.1 정도의 오차가 발생하였다.
어디서 잘못 되었나 좀 더 찾아보니
단타는 총 안타에서 2, 3루타 그리고 홈런을 제외한 숫자를 의미한다.
그러면 단타는 안타의 개수는 7이 아니라 2루타와 홈런을 제외한 5가 된다.
이것을 기반으로 다시 계산하였다.
'''

H = preseason.loc[0, 'H'] - preseason.loc[0, ['2B', '3B', 'HR']].sum()
cnt = 2
SLG = H
for i in preseason.loc[0, ['2B', '3B', 'HR']]:
    SLG += i * cnt
    cnt += 1

SLG = SLG / preseason.loc[0, "AB"]
print(f'clac_SLG: {SLG}')
print(f'orig_SLG: {preseason.loc[0, "SLG"]}')
```

    clac_SLG: H    0.285714
    Name: 0, dtype: object
    orig_SLG: 0.55
    
    clac_SLG: 0.65
    orig_SLG: 0.55
    
    clac_SLG: 0.55
    orig_SLG: 0.55



```python
'''
이제 저 계산식을 기반으로 NaN 값을 채우려고 한다.

이제 SLG는 다 채웠으니 OBP만 채우면 된다.
'''

def SLG_calc(row):
    # SLG가 NaN이 아닐 경우 그대로 반환
    if pd.notna(row['SLG']):
        return row['SLG']
    # 타수가 없는 경우
    if pd.notna(row['AB']) or row['AB'] == 0:
        return 0
    H = row['H'] - row[['2B', '3B', 'HR']].sum()
    SLG = (H + row['2B'] * 2 + row['3B'] * 3 + row['HR'] * 4) / row['AB']

    return SLG
    
display(preseason.head())
print()
preseason['SLG'] = preseason.apply(SLG_calc, axis=1)
display(preseason.head())

for i, j in preseason.isnull().sum().items():
    if not j == 0:
        print(i, j)
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>2018</td>
      <td>LG</td>
      <td>0.350</td>
      <td>7</td>
      <td>20</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.550</td>
      <td>0.409</td>
      <td>1</td>
      <td>177cm/93kg</td>
      <td>1985년 04월 12일</td>
      <td>내야수(우투우타)</td>
      <td>쿠바 Ciego de Avila Maximo Gomez Baez(대)</td>
      <td>NaN</td>
      <td>0.959</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>강경학</td>
      <td>2011</td>
      <td>한화</td>
      <td>0.000</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.500</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>강경학</td>
      <td>2014</td>
      <td>한화</td>
      <td>-</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>강경학</td>
      <td>2015</td>
      <td>한화</td>
      <td>0.130</td>
      <td>10</td>
      <td>23</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>0.130</td>
      <td>0.286</td>
      <td>2</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>강경학</td>
      <td>2016</td>
      <td>한화</td>
      <td>0.188</td>
      <td>14</td>
      <td>32</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
      <td>0.281</td>
      <td>0.212</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.493</td>
    </tr>
  </tbody>
</table>
</div>


    



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>2018</td>
      <td>LG</td>
      <td>0.350</td>
      <td>7</td>
      <td>20</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.550</td>
      <td>0.409</td>
      <td>1</td>
      <td>177cm/93kg</td>
      <td>1985년 04월 12일</td>
      <td>내야수(우투우타)</td>
      <td>쿠바 Ciego de Avila Maximo Gomez Baez(대)</td>
      <td>NaN</td>
      <td>0.959</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>강경학</td>
      <td>2011</td>
      <td>한화</td>
      <td>0.000</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.500</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>강경학</td>
      <td>2014</td>
      <td>한화</td>
      <td>-</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.000</td>
      <td>NaN</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>강경학</td>
      <td>2015</td>
      <td>한화</td>
      <td>0.130</td>
      <td>10</td>
      <td>23</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>0.130</td>
      <td>0.286</td>
      <td>2</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>강경학</td>
      <td>2016</td>
      <td>한화</td>
      <td>0.188</td>
      <td>14</td>
      <td>32</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
      <td>0.281</td>
      <td>0.212</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.493</td>
    </tr>
  </tbody>
</table>
</div>


    OBP 25
    starting_salary 214
    OPS 29



```python
'''
출루율의 계산 공식은 아래와 같다.
(안타 + 볼넷 + 사구) / (타수 + 볼넷 + 사구 + 희생 플라이)

하지만 주어진 데이터에는 희생 플라이는 존재하지 않는다.
그렇기 때문에 일단 0으로 두고 계산해 보았다.

이것으로 한 번 계산해 보았다.
'''

print(f'clac_OPS: {preseason.loc[0, ["H", "BB", "HBP"]].sum() / preseason.loc[0, ["AB", "BB", "HBP"]].sum()}')
print(f'orig_OPS: {preseason.loc[0, ["OBP"]]}')

'''
제대로 된 계산식임을 확인 하였기에 위와 똑같이 채워 주었다.
'''

def OBP_calc(row):
    # OBP가 NaN이 아닐 경우 그대로 반환
    if pd.notna(row['OBP']):
        return row['OBP']
    
    denominator = row[['H', 'BB', 'HBP']].sum()
    numerator = row[['AB', 'BB', 'HBP']].sum()
    
    # 분모 또는 분자가 0 인경우
    if denominator == 0 or numerator == 0:
        return 0
    
    OBP = denominator / numerator
    return OBP

preseason['OBP'] = preseason.apply(OBP_calc, axis=1)
display(preseason.head())

for i, j in preseason.isnull().sum().items():
    if not j == 0:
        print(i, j)
```

    clac_OPS: 0.4090909090909091
    orig_OPS: OBP    0.409
    Name: 0, dtype: object



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>2018</td>
      <td>LG</td>
      <td>0.350</td>
      <td>7</td>
      <td>20</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.550</td>
      <td>0.409</td>
      <td>1</td>
      <td>177cm/93kg</td>
      <td>1985년 04월 12일</td>
      <td>내야수(우투우타)</td>
      <td>쿠바 Ciego de Avila Maximo Gomez Baez(대)</td>
      <td>NaN</td>
      <td>0.959</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>강경학</td>
      <td>2011</td>
      <td>한화</td>
      <td>0.000</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.500</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>강경학</td>
      <td>2014</td>
      <td>한화</td>
      <td>-</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>강경학</td>
      <td>2015</td>
      <td>한화</td>
      <td>0.130</td>
      <td>10</td>
      <td>23</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>0.130</td>
      <td>0.286</td>
      <td>2</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>강경학</td>
      <td>2016</td>
      <td>한화</td>
      <td>0.188</td>
      <td>14</td>
      <td>32</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
      <td>0.281</td>
      <td>0.212</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.493</td>
    </tr>
  </tbody>
</table>
</div>


    starting_salary 214
    OPS 29



```python
# OPS 계산
# OPS = SLG + OPB

def OPS_clac(row):
    return row[['SLG', 'OBP']].sum()

preseason['OPS'] = preseason.apply(OPS_clac, axis=1)
display(preseason)
for i, j in preseason.isnull().sum().items():
    if not j == 0:
        print(i, j)
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>2018</td>
      <td>LG</td>
      <td>0.350</td>
      <td>7</td>
      <td>20</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.550</td>
      <td>0.409</td>
      <td>1</td>
      <td>177cm/93kg</td>
      <td>1985년 04월 12일</td>
      <td>내야수(우투우타)</td>
      <td>쿠바 Ciego de Avila Maximo Gomez Baez(대)</td>
      <td>NaN</td>
      <td>0.959</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>강경학</td>
      <td>2011</td>
      <td>한화</td>
      <td>0.000</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.500</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>강경학</td>
      <td>2014</td>
      <td>한화</td>
      <td>-</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>강경학</td>
      <td>2015</td>
      <td>한화</td>
      <td>0.130</td>
      <td>10</td>
      <td>23</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>0.130</td>
      <td>0.286</td>
      <td>2</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>강경학</td>
      <td>2016</td>
      <td>한화</td>
      <td>0.188</td>
      <td>14</td>
      <td>32</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
      <td>0.281</td>
      <td>0.212</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.493</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1388</th>
      <td>342</td>
      <td>황재균</td>
      <td>2014</td>
      <td>롯데</td>
      <td>0.407</td>
      <td>10</td>
      <td>27</td>
      <td>3</td>
      <td>11</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>16</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0.593</td>
      <td>0.448</td>
      <td>1</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>1.041</td>
    </tr>
    <tr>
      <th>1389</th>
      <td>342</td>
      <td>황재균</td>
      <td>2015</td>
      <td>롯데</td>
      <td>0.333</td>
      <td>11</td>
      <td>30</td>
      <td>8</td>
      <td>10</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0.433</td>
      <td>0.389</td>
      <td>0</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>0.822</td>
    </tr>
    <tr>
      <th>1390</th>
      <td>342</td>
      <td>황재균</td>
      <td>2016</td>
      <td>롯데</td>
      <td>0.310</td>
      <td>16</td>
      <td>42</td>
      <td>8</td>
      <td>13</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>18</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0.429</td>
      <td>0.370</td>
      <td>1</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>0.799</td>
    </tr>
    <tr>
      <th>1391</th>
      <td>342</td>
      <td>황재균</td>
      <td>2018</td>
      <td>KT</td>
      <td>0.250</td>
      <td>6</td>
      <td>16</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0.500</td>
      <td>0.333</td>
      <td>3</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>0.833</td>
    </tr>
    <tr>
      <th>1392</th>
      <td>344</td>
      <td>황진수</td>
      <td>2014</td>
      <td>롯데</td>
      <td>0.000</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>181cm/82kg</td>
      <td>1989년 02월 15일</td>
      <td>내야수(우투양타)</td>
      <td>석천초-대헌중-공주고</td>
      <td>4000만원</td>
      <td>0.000</td>
    </tr>
  </tbody>
</table>
<p>1393 rows × 29 columns</p>
</div>


    starting_salary 214


## 연도별 선수 수 확인


```python
'''
그렇다면 각 연도별 등록된 선수의 수는 어떻게 될지 한 번 살펴보았다.
'''

batter_count_preseason = preseason.groupby('year')['batter_id'].count().rename('preseason').reset_index()
batter_count_preseason
batter_count_preseason.plot(kind='line', x='year', y='preseason')

'''
최근으로 올 수록 등록된 선수의 수가 늘어나는 것을 볼 수 있다.
''';
```


    
![png](/assets/img/main4_files/main4_20_0.png)
    



```python
'''
이제 프리시즌과 정규시즌의 상관관계를 보려고 한다.
프리시즌의 성적이 정규시즌에 영향을 미치는가?

프리시즌에 성적이 좋았던 선수들은 과연 정규시즌에서도 성적이 좋은지 확인하려고 한다.

먼저 정규시즌을 불러오고 결측값을 확인한 후 채우는 작업을 한다.
'''

regular_season = pd.read_csv('./datas/Regular_Season_Batter.csv')
regular_season.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>2018</td>
      <td>LG</td>
      <td>0.339</td>
      <td>50</td>
      <td>183</td>
      <td>27</td>
      <td>62</td>
      <td>9</td>
      <td>0</td>
      <td>8</td>
      <td>95</td>
      <td>34</td>
      <td>5</td>
      <td>0</td>
      <td>9</td>
      <td>8</td>
      <td>25</td>
      <td>3</td>
      <td>0.519</td>
      <td>0.383</td>
      <td>9</td>
      <td>177cm/93kg</td>
      <td>1985년 04월 12일</td>
      <td>내야수(우투우타)</td>
      <td>쿠바 Ciego de Avila Maximo Gomez Baez(대)</td>
      <td>NaN</td>
      <td>0.902</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>강경학</td>
      <td>2011</td>
      <td>한화</td>
      <td>0.000</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>강경학</td>
      <td>2014</td>
      <td>한화</td>
      <td>0.221</td>
      <td>41</td>
      <td>86</td>
      <td>11</td>
      <td>19</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>30</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>2</td>
      <td>28</td>
      <td>1</td>
      <td>0.349</td>
      <td>0.337</td>
      <td>6</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.686</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>강경학</td>
      <td>2015</td>
      <td>한화</td>
      <td>0.257</td>
      <td>120</td>
      <td>311</td>
      <td>50</td>
      <td>80</td>
      <td>7</td>
      <td>4</td>
      <td>2</td>
      <td>101</td>
      <td>27</td>
      <td>4</td>
      <td>3</td>
      <td>40</td>
      <td>5</td>
      <td>58</td>
      <td>3</td>
      <td>0.325</td>
      <td>0.348</td>
      <td>15</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.673</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>강경학</td>
      <td>2016</td>
      <td>한화</td>
      <td>0.158</td>
      <td>46</td>
      <td>101</td>
      <td>16</td>
      <td>16</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>26</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>2</td>
      <td>30</td>
      <td>5</td>
      <td>0.257</td>
      <td>0.232</td>
      <td>7</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.489</td>
    </tr>
  </tbody>
</table>
</div>




```python
'''
타율, SLG, OBP에서 각각 결측값이 발견되었다.
'''

regular_season.isna().sum()
```




    batter_id             0
    batter_name           0
    year                  0
    team                  0
    avg                  26
    G                     0
    AB                    0
    R                     0
    H                     0
    2B                    0
    3B                    0
    HR                    0
    TB                    0
    RBI                   0
    SB                    0
    CS                    0
    BB                    0
    HBP                   0
    SO                    0
    GDP                   0
    SLG                  26
    OBP                  24
    E                     0
    height/weight       802
    year_born             0
    position            802
    career                0
    starting_salary    1067
    OPS                  26
    dtype: int64



## 정규시즌 결측값 채우기


```python
'''
먼저 SLG, OBP는 앞서 사용한 방식을 이용하여 채워주었다.
'''

def SLG_calc(row):
    # SLG가 NaN이 아닐 경우 그대로 반환
    if pd.notna(row['SLG']):
        return row['SLG']
    # 타수가 없는 경우
    if pd.notna(row['AB']) or row['AB'] == 0:
        return 0
    H = row['H'] - row[['2B', '3B', 'HR']].sum()
    SLG = (H + row['2B'] * 2 + row['3B'] * 3 + row['HR'] * 4) / row['AB']

    return SLG

def OBP_calc(row):
    # OBP가 NaN이 아닐 경우 그대로 반환
    if pd.notna(row['OBP']):
        return row['OBP']
    
    denominator = row[['H', 'BB', 'HBP']].sum()
    numerator = row[['AB', 'BB', 'HBP']].sum()
    
    # 분모 또는 분자가 0 인경우
    if denominator == 0 or numerator == 0:
        return 0
    
    OBP = denominator / numerator
    return OBP

# SLG 결측값 채우기
regular_season['SLG'] = regular_season.apply(SLG_calc, axis=1)
# OBP 결측값 채우기
regular_season['OBP'] = regular_season.apply(OBP_calc, axis=1)

# 결측값 확인
regular_season.isna().sum()
```




    batter_id             0
    batter_name           0
    year                  0
    team                  0
    avg                  26
    G                     0
    AB                    0
    R                     0
    H                     0
    2B                    0
    3B                    0
    HR                    0
    TB                    0
    RBI                   0
    SB                    0
    CS                    0
    BB                    0
    HBP                   0
    SO                    0
    GDP                   0
    SLG                   0
    OBP                   0
    E                     0
    height/weight       802
    year_born             0
    position            802
    career                0
    starting_salary    1067
    OPS                  26
    dtype: int64




```python
'''
이제 SLG와 OBP를 채워주었으니 둘을 이용해 OPS를 채워주었다.
'''

def OPS_clac(row):
    # OBP가 NaN이 아닐 경우 그대로 반환
    if pd.notna(row['OPS']):
        return row['OPS']
    
    OPS = row[['SLG', 'OBP']].sum()
    return OPS

# OPS 결측값 채우기
regular_season['OPS'] = regular_season.apply(OPS_clac, axis=1)
# 결측값 확인
regular_season.isna().sum()
```




    batter_id             0
    batter_name           0
    year                  0
    team                  0
    avg                  26
    G                     0
    AB                    0
    R                     0
    H                     0
    2B                    0
    3B                    0
    HR                    0
    TB                    0
    RBI                   0
    SB                    0
    CS                    0
    BB                    0
    HBP                   0
    SO                    0
    GDP                   0
    SLG                   0
    OBP                   0
    E                     0
    height/weight       802
    year_born             0
    position            802
    career                0
    starting_salary    1067
    OPS                   0
    dtype: int64




```python
'''
이제 타율을 채워주도록 하자

타율은 안타 / 타수로
AVG = H / AB 로 계산한다.

먼저 제대로 맞는지 확인해 보자
'''

print(regular_season.loc[0, 'H'] / regular_season.loc[0, 'AB'])
print(regular_season.loc[0, 'avg'])

'''
셋째 자리엣 반올림 하면 될 것 같다.
공식을 이용해서 적용했다.
'''

def AVG_calc(row):
    # avg가 이미 채워진 경우
    if pd.notna(row['avg']):
        return row['avg']
    # 타수 또는 안타가 0인 경우
    if row['AB'] == 0 or row['H'] == 0:
        return 0
    
    avg = regular_season.loc[0, 'H'] / regular_season.loc[0, 'AB']
    avg = round(avg, 3)
    return avg

regular_season['avg'] = regular_season.apply(AVG_calc, axis=1)

# 결측값 확인
regular_season.isna().sum()
```

    0.33879781420765026
    0.339





    batter_id             0
    batter_name           0
    year                  0
    team                  0
    avg                   0
    G                     0
    AB                    0
    R                     0
    H                     0
    2B                    0
    3B                    0
    HR                    0
    TB                    0
    RBI                   0
    SB                    0
    CS                    0
    BB                    0
    HBP                   0
    SO                    0
    GDP                   0
    SLG                   0
    OBP                   0
    E                     0
    height/weight       802
    year_born             0
    position            802
    career                0
    starting_salary    1067
    OPS                   0
    dtype: int64




```python
'''
먼저 정규시즌도 프리시즌과 똑같이 기초통계량을 확인해 보았다.
'''

display(regular_season.describe())

'''
정규 시즌은 프리시즌과 다르게 선수의 수가 매우 많다.

기록된 연도 또한 93년 부터 18년까지 존재한다.

그렇다면 프리시즌과 비교할 때 문제가 생길 수 있으므로 정규시즌과 프리시즌 두 곳에 모두 있는 선수과 연도만 사용해야할 것 같다.
''';
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>year</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>178.079462</td>
      <td>2011.614507</td>
      <td>0.235042</td>
      <td>72.535045</td>
      <td>201.514670</td>
      <td>29.912388</td>
      <td>55.988183</td>
      <td>9.863488</td>
      <td>0.957620</td>
      <td>5.504075</td>
      <td>84.279136</td>
      <td>27.788509</td>
      <td>5.290139</td>
      <td>2.335778</td>
      <td>20.943765</td>
      <td>3.424613</td>
      <td>38.596985</td>
      <td>4.603504</td>
      <td>0.340183</td>
      <td>0.303684</td>
      <td>3.676447</td>
      <td>0.643868</td>
    </tr>
    <tr>
      <th>std</th>
      <td>97.557947</td>
      <td>4.992833</td>
      <td>0.100894</td>
      <td>45.093871</td>
      <td>169.537029</td>
      <td>28.778759</td>
      <td>52.253844</td>
      <td>9.871314</td>
      <td>1.647193</td>
      <td>7.989380</td>
      <td>82.854200</td>
      <td>29.602966</td>
      <td>9.088580</td>
      <td>3.194045</td>
      <td>21.206113</td>
      <td>4.132614</td>
      <td>31.801466</td>
      <td>4.713531</td>
      <td>0.166238</td>
      <td>0.115253</td>
      <td>4.585248</td>
      <td>0.268184</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1993.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>101.250000</td>
      <td>2008.000000</td>
      <td>0.200000</td>
      <td>28.000000</td>
      <td>38.250000</td>
      <td>5.000000</td>
      <td>8.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>10.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>10.000000</td>
      <td>1.000000</td>
      <td>0.263158</td>
      <td>0.269000</td>
      <td>0.000000</td>
      <td>0.541000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>183.000000</td>
      <td>2013.000000</td>
      <td>0.253000</td>
      <td>79.000000</td>
      <td>163.000000</td>
      <td>21.000000</td>
      <td>40.000000</td>
      <td>7.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>56.000000</td>
      <td>17.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>14.000000</td>
      <td>2.000000</td>
      <td>33.000000</td>
      <td>3.000000</td>
      <td>0.358000</td>
      <td>0.328000</td>
      <td>2.000000</td>
      <td>0.686000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>265.000000</td>
      <td>2016.000000</td>
      <td>0.290000</td>
      <td>115.000000</td>
      <td>357.500000</td>
      <td>49.000000</td>
      <td>100.000000</td>
      <td>16.000000</td>
      <td>1.000000</td>
      <td>8.000000</td>
      <td>146.000000</td>
      <td>44.000000</td>
      <td>6.000000</td>
      <td>3.000000</td>
      <td>34.000000</td>
      <td>5.000000</td>
      <td>60.000000</td>
      <td>7.000000</td>
      <td>0.434946</td>
      <td>0.367000</td>
      <td>5.000000</td>
      <td>0.797000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>344.000000</td>
      <td>2018.000000</td>
      <td>1.000000</td>
      <td>144.000000</td>
      <td>600.000000</td>
      <td>135.000000</td>
      <td>201.000000</td>
      <td>47.000000</td>
      <td>17.000000</td>
      <td>53.000000</td>
      <td>377.000000</td>
      <td>146.000000</td>
      <td>84.000000</td>
      <td>21.000000</td>
      <td>108.000000</td>
      <td>27.000000</td>
      <td>161.000000</td>
      <td>24.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>30.000000</td>
      <td>4.000000</td>
    </tr>
  </tbody>
</table>
</div>



```python
'''
각 시즌에서 타자이름, 연도를 이용하여 새로운 인덱스를 만들고, 그 인덱스들을 교집합하여 나온 데이터를 이용하려고 한다.
'''

regular_season['new_index'] = regular_season['batter_name'] + regular_season['year'].apply(str)
preseason['new_index'] = preseason['batter_name'] + preseason['year'].apply(str)

intersection_batter = list(set(regular_season['new_index']).intersection(set(preseason['new_index'])))
print('교집합 된 선수의 수: ',len(intersection_batter))
print(sorted(intersection_batter))

'''
처음에 이상했다.
분명 앞에서 프리시즌을 확인 했을 때는 344명이였는데 왜 1358명이라는 교집합 수가 나올까
그래서 다시 확인 했는데 count 수를 보지 않고 max 수를 보았다....
''';
```

    교집합 된 선수의 수:  1358
    ['가르시아2018', '강경학2011', '강경학2014', '강경학2015', '강경학2016', '강경학2017', '강구성2013', '강구성2016', '강구성2017', '강민국2014', '강민국2015', '강민국2016', '강민호2005', '강민호2006', '강민호2007', '강민호2008', '강민호2009', '강민호2010', '강민호2011', '강민호2012', '강민호2013', '강민호2014', '강민호2015', '강민호2016', '강민호2017', '강민호2018', '강백호2018', '강상원2017', '강상원2018', '강승호2016', '강승호2017', '강승호2018', '강진성2017', '강진성2018', '강한울2014', '강한울2015', '강한울2017', '강한울2018', '고종욱2011', '고종욱2015', '고종욱2016', '고종욱2017', '고종욱2018', '구자욱2015', '구자욱2016', '구자욱2017', '구자욱2018', '국해성2012', '국해성2015', '국해성2016', '국해성2017', '국해성2018', '권정웅2016', '권정웅2017', '권정웅2018', '권희동2013', '권희동2014', '권희동2017', '권희동2018', '김강민2003', '김강민2004', '김강민2005', '김강민2006', '김강민2007', '김강민2008', '김강민2009', '김강민2010', '김강민2011', '김강민2012', '김강민2013', '김강민2014', '김강민2015', '김강민2016', '김강민2017', '김강민2018', '김동엽2016', '김동엽2017', '김동엽2018', '김동욱2013', '김동욱2015', '김동욱2016', '김동욱2017', '김동욱2018', '김동한2013', '김동한2016', '김동한2017', '김동한2018', '김문호2007', '김문호2008', '김문호2011', '김문호2012', '김문호2013', '김문호2014', '김문호2015', '김문호2016', '김문호2017', '김문호2018', '김민성2007', '김민성2009', '김민성2010', '김민성2011', '김민성2012', '김민성2013', '김민성2014', '김민성2015', '김민성2016', '김민성2017', '김민성2018', '김민수2014', '김민수2018', '김민식2015', '김민식2016', '김민식2017', '김민식2018', '김민하2014', '김민하2015', '김사훈2012', '김사훈2013', '김사훈2014', '김사훈2017', '김사훈2018', '김상수2009', '김상수2010', '김상수2011', '김상수2012', '김상수2013', '김상수2014', '김상수2015', '김상수2016', '김상수2017', '김상수2018', '김상호2012', '김상호2016', '김상호2017', '김선빈2008', '김선빈2009', '김선빈2010', '김선빈2011', '김선빈2012', '김선빈2013', '김선빈2014', '김선빈2017', '김선빈2018', '김성욱2013', '김성욱2014', '김성욱2015', '김성욱2016', '김성욱2017', '김성욱2018', '김성현2006', '김성현2007', '김성현2008', '김성현2011', '김성현2012', '김성현2013', '김성현2014', '김성현2015', '김성현2016', '김성현2017', '김성현2018', '김성훈2018', '김용의2008', '김용의2012', '김용의2013', '김용의2014', '김용의2015', '김용의2016', '김용의2017', '김용의2018', '김응민2014', '김인태2017', '김재성2015', '김재율2012', '김재율2015', '김재율2017', '김재율2018', '김재현2014', '김재현2015', '김재현2016', '김재호2004', '김재호2005', '김재호2008', '김재호2009', '김재호2010', '김재호2011', '김재호2012', '김재호2013', '김재호2014', '김재호2015', '김재호2016', '김재호2017', '김재호2018', '김재환2008', '김재환2011', '김재환2014', '김재환2015', '김재환2016', '김재환2017', '김재환2018', '김주찬2002', '김주찬2003', '김주찬2004', '김주찬2008', '김주찬2009', '김주찬2010', '김주찬2011', '김주찬2012', '김주찬2013', '김주찬2014', '김주찬2015', '김주찬2016', '김주찬2017', '김주찬2018', '김주형2004', '김주형2005', '김주형2006', '김주형2007', '김주형2008', '김주형2011', '김주형2013', '김주형2014', '김주형2016', '김주형2017', '김주형2018', '김지수2010', '김지수2014', '김지수2015', '김지수2016', '김지수2017', '김지수2018', '김진곤2015', '김태균2002', '김태균2003', '김태균2004', '김태균2005', '김태균2006', '김태균2007', '김태균2008', '김태균2009', '김태균2012', '김태균2013', '김태균2014', '김태균2015', '김태균2016', '김태균2017', '김태균2018', '김태연2018', '김태완2006', '김태완2007', '김태완2008', '김태완2009', '김태완2010', '김태완2013', '김태완2014', '김태완2016', '김태완2017', '김태완2018', '김태진2016', '김하성2015', '김하성2016', '김하성2017', '김하성2018', '김헌곤2011', '김헌곤2012', '김헌곤2013', '김헌곤2014', '김헌곤2017', '김헌곤2018', '김현수2007', '김현수2008', '김현수2009', '김현수2010', '김현수2011', '김현수2012', '김현수2013', '김현수2014', '김현수2015', '김현수2018', '김혜성2017', '김혜성2018', '김회성2009', '김회성2010', '김회성2014', '김회성2015', '김회성2017', '나경민2017', '나경민2018', '나성범2014', '나성범2015', '나성범2016', '나성범2017', '나성범2018', '나원탁2017', '나원탁2018', '나종덕2017', '나종덕2018', '나주환2003', '나주환2004', '나주환2005', '나주환2006', '나주환2007', '나주환2008', '나주환2009', '나주환2010', '나주환2014', '나주환2015', '나주환2017', '나주환2018', '나지완2008', '나지완2009', '나지완2010', '나지완2012', '나지완2013', '나지완2014', '나지완2015', '나지완2016', '나지완2017', '나지완2018', '남태혁2016', '남태혁2017', '남태혁2018', '노수광2015', '노수광2016', '노수광2017', '노수광2018', '노진혁2013', '노진혁2014', '노진혁2015', '노진혁2018', '도태훈2016', '도태훈2017', '도태훈2018', '러프2017', '러프2018', '로맥2018', '로하스2018', '류지혁2016', '류지혁2017', '류지혁2018', '모창민2008', '모창민2009', '모창민2010', '모창민2013', '모창민2014', '모창민2015', '모창민2017', '모창민2018', '문규현2004', '문규현2007', '문규현2009', '문규현2010', '문규현2011', '문규현2012', '문규현2013', '문규현2014', '문규현2015', '문규현2016', '문규현2017', '문규현2018', '문선재2013', '문선재2014', '문선재2015', '문선재2016', '문선재2017', '민병헌2006', '민병헌2007', '민병헌2008', '민병헌2009', '민병헌2010', '민병헌2013', '민병헌2014', '민병헌2015', '민병헌2016', '민병헌2017', '민병헌2018', '박건우2013', '박건우2014', '박건우2015', '박건우2016', '박건우2017', '박건우2018', '박경수2003', '박경수2004', '박경수2005', '박경수2006', '박경수2007', '박경수2008', '박경수2009', '박경수2010', '박경수2011', '박경수2015', '박경수2016', '박경수2017', '박경수2018', '박광열2015', '박광열2016', '박광열2017', '박광열2018', '박기혁2002', '박기혁2003', '박기혁2004', '박기혁2005', '박기혁2006', '박기혁2007', '박기혁2008', '박기혁2009', '박기혁2010', '박기혁2013', '박기혁2015', '박기혁2016', '박기혁2017', '박기혁2018', '박동원2013', '박동원2014', '박동원2015', '박동원2016', '박동원2017', '박동원2018', '박민우2013', '박민우2014', '박민우2015', '박민우2016', '박민우2018', '박병호2005', '박병호2006', '박병호2009', '박병호2010', '박병호2012', '박병호2013', '박병호2014', '박병호2015', '박병호2018', '박석민2004', '박석민2008', '박석민2009', '박석민2010', '박석민2011', '박석민2012', '박석민2013', '박석민2014', '박석민2015', '박석민2016', '박석민2017', '박석민2018', '박세혁2012', '박세혁2013', '박세혁2016', '박세혁2017', '박세혁2018', '박승욱2013', '박승욱2017', '박승욱2018', '박용택2002', '박용택2003', '박용택2004', '박용택2005', '박용택2006', '박용택2007', '박용택2008', '박용택2009', '박용택2010', '박용택2011', '박용택2012', '박용택2013', '박용택2014', '박용택2015', '박용택2016', '박용택2017', '박용택2018', '박정권2004', '박정권2007', '박정권2008', '박정권2009', '박정권2010', '박정권2011', '박정권2012', '박정권2013', '박정권2014', '박정권2015', '박정권2016', '박정권2017', '박정권2018', '박정음2016', '박정음2017', '박준태2014', '박준태2015', '박지규2015', '박지규2018', '박찬도2014', '박찬도2015', '박한이2002', '박한이2003', '박한이2004', '박한이2005', '박한이2006', '박한이2007', '박한이2008', '박한이2009', '박한이2010', '박한이2011', '박한이2012', '박한이2013', '박한이2014', '박한이2015', '박한이2016', '박한이2018', '박해민2015', '박해민2016', '박해민2017', '박해민2018', '박헌도2013', '박헌도2014', '박헌도2015', '박헌도2016', '박헌도2017', '박헌도2018', '배영섭2011', '배영섭2012', '배영섭2013', '배영섭2016', '배영섭2017', '배영섭2018', '배정대2015', '배정대2016', '백민기2015', '백민기2018', '백상원2013', '백상원2014', '백상원2015', '백상원2016', '백상원2017', '백용환2014', '백용환2015', '백용환2016', '백용환2018', '백창수2010', '백창수2014', '백창수2015', '백창수2016', '백창수2018', '버나디나2017', '버나디나2018', '번즈2017', '번즈2018', '서건창2012', '서건창2013', '서건창2014', '서건창2015', '서건창2016', '서건창2017', '서건창2018', '서동욱2003', '서동욱2004', '서동욱2005', '서동욱2008', '서동욱2009', '서동욱2010', '서동욱2011', '서동욱2012', '서동욱2013', '서동욱2014', '서동욱2015', '서동욱2016', '서동욱2017', '서동욱2018', '서상우2016', '서상우2017', '손시헌2004', '손시헌2005', '손시헌2006', '손시헌2009', '손시헌2010', '손시헌2011', '손시헌2012', '손시헌2013', '손시헌2014', '손시헌2015', '손시헌2016', '손시헌2017', '손시헌2018', '손아섭2007', '손아섭2008', '손아섭2009', '손아섭2010', '손아섭2011', '손아섭2013', '손아섭2014', '손아섭2015', '손아섭2016', '손아섭2017', '손아섭2018', '손주인2005', '손주인2008', '손주인2009', '손주인2010', '손주인2011', '손주인2012', '손주인2013', '손주인2014', '손주인2015', '손주인2016', '손주인2017', '손주인2018', '송광민2006', '송광민2007', '송광민2008', '송광민2009', '송광민2010', '송광민2014', '송광민2015', '송광민2017', '송광민2018', '송민섭2015', '송민섭2018', '송성문2017', '스크럭스2017', '스크럭스2018', '신본기2012', '신본기2013', '신본기2014', '신본기2017', '신본기2018', '신성현2016', '신성현2017', '신성현2018', '신종길2003', '신종길2004', '신종길2011', '신종길2012', '신종길2013', '신종길2014', '신종길2015', '신종길2017', '심우준2015', '심우준2016', '심우준2017', '심우준2018', '안익훈2015', '안익훈2016', '안익훈2018', '안중열2015', '안중열2016', '안치홍2009', '안치홍2010', '안치홍2011', '안치홍2012', '안치홍2013', '안치홍2014', '안치홍2017', '안치홍2018', '양석환2015', '양석환2016', '양석환2017', '양석환2018', '양성우2012', '양성우2016', '양성우2017', '양성우2018', '양의지2010', '양의지2011', '양의지2012', '양의지2013', '양의지2014', '양의지2015', '양의지2016', '양의지2017', '양의지2018', '양종민2009', '양종민2010', '양종민2014', '양종민2015', '양종민2018', '엄태용2014', '오선진2008', '오선진2009', '오선진2010', '오선진2011', '오선진2012', '오선진2013', '오선진2016', '오선진2017', '오선진2018', '오재원2008', '오재원2009', '오재원2010', '오재원2011', '오재원2012', '오재원2013', '오재원2014', '오재원2015', '오재원2016', '오재원2017', '오재원2018', '오재일2009', '오재일2010', '오재일2011', '오재일2012', '오재일2013', '오재일2014', '오재일2015', '오재일2016', '오재일2017', '오재일2018', '오정복2010', '오정복2011', '오정복2014', '오정복2015', '오정복2016', '오정복2017', '오정복2018', '오지환2009', '오지환2010', '오지환2011', '오지환2012', '오지환2013', '오지환2014', '오지환2015', '오지환2017', '오지환2018', '오태곤2014', '오태곤2015', '오태곤2016', '오태곤2017', '오태곤2018', '유강남2012', '유강남2015', '유강남2016', '유강남2017', '유강남2018', '유민상2018', '유재신2008', '유재신2009', '유재신2012', '유재신2013', '유재신2014', '유재신2015', '유재신2016', '유재신2018', '유한준2005', '유한준2006', '유한준2007', '유한준2010', '유한준2011', '유한준2013', '유한준2014', '유한준2015', '유한준2016', '유한준2017', '유한준2018', '윤병호2015', '윤병호2016', '윤병호2017', '윤병호2018', '윤석민2005', '윤석민2007', '윤석민2011', '윤석민2012', '윤석민2014', '윤석민2015', '윤석민2016', '윤석민2017', '윤석민2018', '윤수강2012', '윤수강2018', '윤정우2011', '윤정우2012', '윤정우2016', '윤진호2011', '윤진호2012', '윤진호2015', '윤진호2016', '윤진호2018', '이대수2004', '이대수2005', '이대수2006', '이대수2007', '이대수2008', '이대수2009', '이대수2010', '이대수2011', '이대수2012', '이대수2013', '이대수2014', '이대수2015', '이대수2016', '이대수2017', '이대형2003', '이대형2005', '이대형2006', '이대형2007', '이대형2008', '이대형2009', '이대형2010', '이대형2011', '이대형2012', '이대형2013', '이대형2014', '이대형2015', '이대형2016', '이대형2017', '이대호2002', '이대호2004', '이대호2005', '이대호2006', '이대호2007', '이대호2008', '이대호2009', '이대호2010', '이대호2011', '이대호2017', '이대호2018', '이동훈2016', '이동훈2017', '이동훈2018', '이명기2010', '이명기2013', '이명기2015', '이명기2016', '이명기2017', '이명기2018', '이범호2002', '이범호2003', '이범호2004', '이범호2005', '이범호2006', '이범호2007', '이범호2008', '이범호2009', '이범호2011', '이범호2012', '이범호2013', '이범호2014', '이범호2015', '이범호2016', '이범호2017', '이범호2018', '이상호2013', '이상호2014', '이상호2017', '이상호2018', '이성곤2014', '이성곤2017', '이성곤2018', '이성열2005', '이성열2006', '이성열2007', '이성열2008', '이성열2009', '이성열2010', '이성열2011', '이성열2012', '이성열2013', '이성열2014', '이성열2015', '이성열2016', '이성열2017', '이성열2018', '이성우2008', '이성우2009', '이성우2010', '이성우2011', '이성우2013', '이성우2015', '이성우2016', '이성우2017', '이성우2018', '이영욱2008', '이영욱2009', '이영욱2010', '이영욱2011', '이영욱2015', '이영욱2016', '이영욱2017', '이영욱2018', '이용규2004', '이용규2005', '이용규2006', '이용규2007', '이용규2008', '이용규2009', '이용규2010', '이용규2011', '이용규2012', '이용규2013', '이용규2014', '이용규2015', '이용규2016', '이용규2018', '이우성2016', '이원석2005', '이원석2006', '이원석2007', '이원석2008', '이원석2009', '이원석2010', '이원석2011', '이원석2012', '이원석2014', '이원석2017', '이원석2018', '이인행2015', '이인행2017', '이재원2006', '이재원2007', '이재원2008', '이재원2010', '이재원2014', '이재원2015', '이재원2016', '이재원2017', '이재원2018', '이재율2016', '이재율2017', '이재율2018', '이정후2017', '이정후2018', '이종욱2006', '이종욱2007', '이종욱2008', '이종욱2009', '이종욱2010', '이종욱2011', '이종욱2012', '이종욱2013', '이종욱2014', '이종욱2015', '이종욱2016', '이종욱2018', '이준수2012', '이준수2013', '이준수2018', '이준호2011', '이준호2012', '이준호2013', '이지영2009', '이지영2012', '이지영2013', '이지영2014', '이지영2015', '이지영2016', '이지영2017', '이지영2018', '이진영2002', '이진영2003', '이진영2004', '이진영2005', '이진영2006', '이진영2007', '이진영2008', '이진영2009', '이진영2010', '이진영2011', '이진영2012', '이진영2013', '이진영2014', '이진영2015', '이진영2016', '이진영2017', '이진영2018', '이천웅2016', '이천웅2017', '이천웅2018', '이택근2003', '이택근2004', '이택근2005', '이택근2006', '이택근2007', '이택근2008', '이택근2009', '이택근2010', '이택근2012', '이택근2013', '이택근2014', '이택근2015', '이택근2016', '이택근2017', '이해창2011', '이해창2016', '이해창2017', '이해창2018', '이형종2016', '이형종2017', '이호신2007', '이호신2009', '이호신2015', '이호신2016', '이호신2017', '이흥련2014', '이흥련2015', '이흥련2016', '임병욱2015', '임병욱2016', '임병욱2017', '임병욱2018', '임종혁2014', '임훈2004', '임훈2010', '임훈2011', '임훈2012', '임훈2013', '임훈2014', '임훈2015', '임훈2016', '임훈2017', '임훈2018', '장민석2008', '장민석2010', '장민석2011', '장민석2012', '장민석2013', '장민석2014', '장민석2015', '장민석2016', '장민석2017', '장성우2009', '장성우2010', '장성우2011', '장성우2014', '장성우2015', '장성우2017', '장성우2018', '장승현2018', '장시윤2016', '장영석2009', '장영석2010', '장영석2011', '장영석2015', '장영석2016', '장영석2018', '장준원2016', '장진혁2018', '전병우2018', '전준우2008', '전준우2009', '전준우2010', '전준우2011', '전준우2012', '전준우2013', '전준우2014', '전준우2017', '전준우2018', '정경운2018', '정근우2005', '정근우2006', '정근우2007', '정근우2008', '정근우2009', '정근우2010', '정근우2011', '정근우2012', '정근우2013', '정근우2014', '정근우2016', '정근우2018', '정범모2006', '정범모2007', '정범모2008', '정범모2012', '정범모2013', '정범모2014', '정범모2018', '정병곤2013', '정병곤2017', '정상호2002', '정상호2003', '정상호2007', '정상호2008', '정상호2010', '정상호2011', '정상호2012', '정상호2014', '정상호2015', '정상호2016', '정상호2017', '정상호2018', '정성훈2002', '정성훈2003', '정성훈2004', '정성훈2005', '정성훈2006', '정성훈2007', '정성훈2008', '정성훈2009', '정성훈2010', '정성훈2011', '정성훈2012', '정성훈2013', '정성훈2014', '정성훈2015', '정성훈2016', '정성훈2017', '정성훈2018', '정수빈2009', '정수빈2010', '정수빈2011', '정수빈2012', '정수빈2013', '정수빈2014', '정수빈2015', '정수빈2016', '정의윤2005', '정의윤2006', '정의윤2008', '정의윤2011', '정의윤2013', '정의윤2014', '정의윤2015', '정의윤2016', '정의윤2017', '정의윤2018', '정주현2009', '정주현2010', '정주현2012', '정주현2013', '정주현2016', '정주현2018', '정주후2016', '정진기2011', '정진기2012', '정진기2017', '정진기2018', '정진호2011', '정진호2012', '정진호2015', '정진호2016', '정진호2017', '정진호2018', '정현2017', '정현2018', '정훈2011', '정훈2012', '정훈2013', '정훈2014', '정훈2015', '정훈2016', '정훈2017', '정훈2018', '조동찬2002', '조동찬2003', '조동찬2004', '조동찬2005', '조동찬2006', '조동찬2007', '조동찬2008', '조동찬2009', '조동찬2010', '조동찬2011', '조동찬2012', '조동찬2013', '조동찬2016', '조동찬2017', '조동찬2018', '조동화2005', '조동화2006', '조동화2007', '조동화2008', '조동화2009', '조동화2010', '조동화2011', '조동화2013', '조동화2014', '조동화2015', '조동화2016', '조수행2016', '조수행2017', '조수행2018', '조윤준2012', '조윤준2013', '조윤준2014', '조윤준2015', '조윤준2017', '조평호2013', '조평호2015', '조평호2016', '조평호2017', '조홍석2013', '조홍석2014', '조홍석2015', '조홍석2018', '주효상2016', '주효상2018', '지석훈2005', '지석훈2006', '지석훈2007', '지석훈2008', '지석훈2011', '지석훈2012', '지석훈2013', '지석훈2014', '지석훈2015', '지석훈2016', '지석훈2017', '지석훈2018', '지성준2015', '지성준2018', '채은성2014', '채은성2015', '채은성2016', '채은성2017', '채은성2018', '채태인2009', '채태인2010', '채태인2011', '채태인2012', '채태인2013', '채태인2014', '채태인2015', '채태인2016', '채태인2017', '채태인2018', '초이스2018', '최승준2014', '최승준2015', '최승준2016', '최승준2018', '최영진2013', '최영진2014', '최영진2017', '최영진2018', '최원제2017', '최원준2016', '최원준2017', '최원준2018', '최윤석2010', '최윤석2011', '최윤석2012', '최윤석2013', '최윤석2016', '최윤석2017', '최윤석2018', '최재훈2012', '최재훈2013', '최재훈2015', '최재훈2016', '최재훈2017', '최재훈2018', '최정2005', '최정2006', '최정2007', '최정2008', '최정2009', '최정2010', '최정2011', '최정2012', '최정2013', '최정2014', '최정2015', '최정2016', '최정2017', '최정2018', '최정민2015', '최정민2016', '최주환2008', '최주환2009', '최주환2012', '최주환2013', '최주환2014', '최주환2015', '최주환2016', '최주환2017', '최주환2018', '최준석2005', '최준석2006', '최준석2007', '최준석2008', '최준석2009', '최준석2010', '최준석2011', '최준석2012', '최준석2013', '최준석2014', '최준석2015', '최준석2016', '최준석2017', '최준석2018', '최진행2004', '최진행2005', '최진행2008', '최진행2009', '최진행2010', '최진행2011', '최진행2012', '최진행2013', '최진행2014', '최진행2015', '최진행2016', '최진행2017', '최진행2018', '최항2017', '최항2018', '최형우2002', '최형우2004', '최형우2008', '최형우2009', '최형우2010', '최형우2011', '최형우2012', '최형우2013', '최형우2014', '최형우2015', '최형우2016', '최형우2017', '최형우2018', '하주석2012', '하주석2013', '하주석2016', '하주석2017', '하주석2018', '하준호2015', '하준호2016', '하준호2017', '한동민2013', '한동민2014', '한동민2017', '한동민2018', '한동희2018', '한승택2013', '한승택2016', '한승택2017', '한승택2018', '허경민2012', '허경민2013', '허경민2014', '허경민2015', '허경민2016', '허경민2017', '허경민2018', '허도환2012', '허도환2013', '허도환2014', '허도환2016', '허도환2017', '허도환2018', '호잉2018', '홍성갑2015', '홍성갑2016', '홍성갑2017', '홍재호2011', '홍재호2012', '홍재호2013', '홍재호2017', '홍재호2018', '홍창기2016', '황윤호2015', '황윤호2016', '황윤호2017', '황윤호2018', '황재균2008', '황재균2009', '황재균2010', '황재균2011', '황재균2012', '황재균2013', '황재균2014', '황재균2015', '황재균2016', '황재균2018', '황진수2014']



```python
# 교집합 된 데이터만 불러오기
regular_season_intersection = regular_season.loc[regular_season['new_index'].apply(lambda x : x in intersection_batter)]
regular_season_intersection.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>year</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
      <td>1358.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>173.113402</td>
      <td>2013.027246</td>
      <td>0.251213</td>
      <td>85.333579</td>
      <td>247.955081</td>
      <td>37.701767</td>
      <td>70.106775</td>
      <td>12.269514</td>
      <td>1.252577</td>
      <td>6.874080</td>
      <td>105.503682</td>
      <td>34.873343</td>
      <td>6.684831</td>
      <td>2.841679</td>
      <td>25.645066</td>
      <td>4.265096</td>
      <td>47.424153</td>
      <td>5.558910</td>
      <td>0.368104</td>
      <td>0.321404</td>
      <td>4.497054</td>
      <td>0.689507</td>
    </tr>
    <tr>
      <th>std</th>
      <td>94.678257</td>
      <td>4.146897</td>
      <td>0.083251</td>
      <td>42.605644</td>
      <td>171.813382</td>
      <td>29.875080</td>
      <td>54.131282</td>
      <td>10.299543</td>
      <td>1.907663</td>
      <td>8.647075</td>
      <td>85.927861</td>
      <td>31.309521</td>
      <td>10.007186</td>
      <td>3.455258</td>
      <td>21.855439</td>
      <td>4.501909</td>
      <td>33.018225</td>
      <td>4.887141</td>
      <td>0.137024</td>
      <td>0.093583</td>
      <td>4.913211</td>
      <td>0.218710</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>2002.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>99.000000</td>
      <td>2010.000000</td>
      <td>0.222000</td>
      <td>51.000000</td>
      <td>78.000000</td>
      <td>10.000000</td>
      <td>17.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>23.000000</td>
      <td>7.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.000000</td>
      <td>1.000000</td>
      <td>18.000000</td>
      <td>1.000000</td>
      <td>0.301250</td>
      <td>0.291000</td>
      <td>1.000000</td>
      <td>0.600500</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>178.000000</td>
      <td>2014.000000</td>
      <td>0.265000</td>
      <td>99.000000</td>
      <td>257.000000</td>
      <td>33.000000</td>
      <td>65.000000</td>
      <td>11.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>93.000000</td>
      <td>28.000000</td>
      <td>3.000000</td>
      <td>2.000000</td>
      <td>22.000000</td>
      <td>3.000000</td>
      <td>47.000000</td>
      <td>5.000000</td>
      <td>0.379500</td>
      <td>0.337000</td>
      <td>3.000000</td>
      <td>0.718000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>252.000000</td>
      <td>2016.750000</td>
      <td>0.299000</td>
      <td>122.000000</td>
      <td>407.000000</td>
      <td>60.000000</td>
      <td>116.000000</td>
      <td>20.000000</td>
      <td>2.000000</td>
      <td>10.000000</td>
      <td>173.000000</td>
      <td>56.000000</td>
      <td>8.750000</td>
      <td>4.000000</td>
      <td>41.000000</td>
      <td>7.000000</td>
      <td>71.000000</td>
      <td>9.000000</td>
      <td>0.451000</td>
      <td>0.372000</td>
      <td>7.000000</td>
      <td>0.818000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>344.000000</td>
      <td>2018.000000</td>
      <td>1.000000</td>
      <td>144.000000</td>
      <td>600.000000</td>
      <td>135.000000</td>
      <td>201.000000</td>
      <td>47.000000</td>
      <td>17.000000</td>
      <td>53.000000</td>
      <td>377.000000</td>
      <td>146.000000</td>
      <td>66.000000</td>
      <td>21.000000</td>
      <td>108.000000</td>
      <td>27.000000</td>
      <td>161.000000</td>
      <td>24.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>30.000000</td>
      <td>2.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
regular_season_intersection.sort_values(by='new_index').reset_index(drop=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
      <th>new_index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>2018</td>
      <td>LG</td>
      <td>0.339</td>
      <td>50</td>
      <td>183</td>
      <td>27</td>
      <td>62</td>
      <td>9</td>
      <td>0</td>
      <td>8</td>
      <td>95</td>
      <td>34</td>
      <td>5</td>
      <td>0</td>
      <td>9</td>
      <td>8</td>
      <td>25</td>
      <td>3</td>
      <td>0.519</td>
      <td>0.383</td>
      <td>9</td>
      <td>177cm/93kg</td>
      <td>1985년 04월 12일</td>
      <td>내야수(우투우타)</td>
      <td>쿠바 Ciego de Avila Maximo Gomez Baez(대)</td>
      <td>NaN</td>
      <td>0.902</td>
      <td>가르시아2018</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>강경학</td>
      <td>2011</td>
      <td>한화</td>
      <td>0.000</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.000</td>
      <td>강경학2011</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>강경학</td>
      <td>2014</td>
      <td>한화</td>
      <td>0.221</td>
      <td>41</td>
      <td>86</td>
      <td>11</td>
      <td>19</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>30</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>2</td>
      <td>28</td>
      <td>1</td>
      <td>0.349</td>
      <td>0.337</td>
      <td>6</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.686</td>
      <td>강경학2014</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>강경학</td>
      <td>2015</td>
      <td>한화</td>
      <td>0.257</td>
      <td>120</td>
      <td>311</td>
      <td>50</td>
      <td>80</td>
      <td>7</td>
      <td>4</td>
      <td>2</td>
      <td>101</td>
      <td>27</td>
      <td>4</td>
      <td>3</td>
      <td>40</td>
      <td>5</td>
      <td>58</td>
      <td>3</td>
      <td>0.325</td>
      <td>0.348</td>
      <td>15</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.673</td>
      <td>강경학2015</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>강경학</td>
      <td>2016</td>
      <td>한화</td>
      <td>0.158</td>
      <td>46</td>
      <td>101</td>
      <td>16</td>
      <td>16</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>26</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>2</td>
      <td>30</td>
      <td>5</td>
      <td>0.257</td>
      <td>0.232</td>
      <td>7</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.489</td>
      <td>강경학2016</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1353</th>
      <td>342</td>
      <td>황재균</td>
      <td>2014</td>
      <td>롯데</td>
      <td>0.321</td>
      <td>128</td>
      <td>486</td>
      <td>66</td>
      <td>156</td>
      <td>33</td>
      <td>3</td>
      <td>12</td>
      <td>231</td>
      <td>76</td>
      <td>17</td>
      <td>10</td>
      <td>53</td>
      <td>3</td>
      <td>86</td>
      <td>8</td>
      <td>0.475</td>
      <td>0.388</td>
      <td>16</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>0.863</td>
      <td>황재균2014</td>
    </tr>
    <tr>
      <th>1354</th>
      <td>342</td>
      <td>황재균</td>
      <td>2015</td>
      <td>롯데</td>
      <td>0.290</td>
      <td>144</td>
      <td>534</td>
      <td>95</td>
      <td>155</td>
      <td>41</td>
      <td>2</td>
      <td>26</td>
      <td>278</td>
      <td>97</td>
      <td>11</td>
      <td>10</td>
      <td>48</td>
      <td>4</td>
      <td>122</td>
      <td>14</td>
      <td>0.521</td>
      <td>0.350</td>
      <td>16</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>0.871</td>
      <td>황재균2015</td>
    </tr>
    <tr>
      <th>1355</th>
      <td>342</td>
      <td>황재균</td>
      <td>2016</td>
      <td>롯데</td>
      <td>0.335</td>
      <td>127</td>
      <td>498</td>
      <td>97</td>
      <td>167</td>
      <td>26</td>
      <td>5</td>
      <td>27</td>
      <td>284</td>
      <td>113</td>
      <td>25</td>
      <td>10</td>
      <td>49</td>
      <td>4</td>
      <td>66</td>
      <td>10</td>
      <td>0.570</td>
      <td>0.394</td>
      <td>15</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>0.964</td>
      <td>황재균2016</td>
    </tr>
    <tr>
      <th>1356</th>
      <td>342</td>
      <td>황재균</td>
      <td>2018</td>
      <td>KT</td>
      <td>0.296</td>
      <td>142</td>
      <td>530</td>
      <td>76</td>
      <td>157</td>
      <td>41</td>
      <td>3</td>
      <td>25</td>
      <td>279</td>
      <td>88</td>
      <td>14</td>
      <td>7</td>
      <td>49</td>
      <td>4</td>
      <td>120</td>
      <td>5</td>
      <td>0.526</td>
      <td>0.358</td>
      <td>17</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>0.884</td>
      <td>황재균2018</td>
    </tr>
    <tr>
      <th>1357</th>
      <td>344</td>
      <td>황진수</td>
      <td>2014</td>
      <td>롯데</td>
      <td>0.000</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>181cm/82kg</td>
      <td>1989년 02월 15일</td>
      <td>내야수(우투양타)</td>
      <td>석천초-대헌중-공주고</td>
      <td>4000만원</td>
      <td>0.000</td>
      <td>황진수2014</td>
    </tr>
  </tbody>
</table>
<p>1358 rows × 30 columns</p>
</div>




```python
# 프리시즌도 똑같이 작업했다.

preseason_intersection = preseason.loc[preseason['new_index'].apply(lambda x: x in intersection_batter)].copy()
preseason_intersection.sort_values(by='new_index').reset_index(drop=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
      <th>new_index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>2018</td>
      <td>LG</td>
      <td>0.350</td>
      <td>7</td>
      <td>20</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.550</td>
      <td>0.409</td>
      <td>1</td>
      <td>177cm/93kg</td>
      <td>1985년 04월 12일</td>
      <td>내야수(우투우타)</td>
      <td>쿠바 Ciego de Avila Maximo Gomez Baez(대)</td>
      <td>NaN</td>
      <td>0.959</td>
      <td>가르시아2018</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>강경학</td>
      <td>2011</td>
      <td>한화</td>
      <td>0.000</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.500</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.500</td>
      <td>강경학2011</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>강경학</td>
      <td>2014</td>
      <td>한화</td>
      <td>-</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.000</td>
      <td>강경학2014</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>강경학</td>
      <td>2015</td>
      <td>한화</td>
      <td>0.130</td>
      <td>10</td>
      <td>23</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>0.130</td>
      <td>0.286</td>
      <td>2</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.416</td>
      <td>강경학2015</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>강경학</td>
      <td>2016</td>
      <td>한화</td>
      <td>0.188</td>
      <td>14</td>
      <td>32</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
      <td>0.281</td>
      <td>0.212</td>
      <td>0</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.493</td>
      <td>강경학2016</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1353</th>
      <td>342</td>
      <td>황재균</td>
      <td>2014</td>
      <td>롯데</td>
      <td>0.407</td>
      <td>10</td>
      <td>27</td>
      <td>3</td>
      <td>11</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>16</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0.593</td>
      <td>0.448</td>
      <td>1</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>1.041</td>
      <td>황재균2014</td>
    </tr>
    <tr>
      <th>1354</th>
      <td>342</td>
      <td>황재균</td>
      <td>2015</td>
      <td>롯데</td>
      <td>0.333</td>
      <td>11</td>
      <td>30</td>
      <td>8</td>
      <td>10</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0.433</td>
      <td>0.389</td>
      <td>0</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>0.822</td>
      <td>황재균2015</td>
    </tr>
    <tr>
      <th>1355</th>
      <td>342</td>
      <td>황재균</td>
      <td>2016</td>
      <td>롯데</td>
      <td>0.310</td>
      <td>16</td>
      <td>42</td>
      <td>8</td>
      <td>13</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>18</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0.429</td>
      <td>0.370</td>
      <td>1</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>0.799</td>
      <td>황재균2016</td>
    </tr>
    <tr>
      <th>1356</th>
      <td>342</td>
      <td>황재균</td>
      <td>2018</td>
      <td>KT</td>
      <td>0.250</td>
      <td>6</td>
      <td>16</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0.500</td>
      <td>0.333</td>
      <td>3</td>
      <td>183cm/96kg</td>
      <td>1987년 07월 28일</td>
      <td>내야수(우투우타)</td>
      <td>사당초-이수중-경기고-현대-우리-히어로즈-넥센-롯데-샌프란시스코</td>
      <td>6000만원</td>
      <td>0.833</td>
      <td>황재균2018</td>
    </tr>
    <tr>
      <th>1357</th>
      <td>344</td>
      <td>황진수</td>
      <td>2014</td>
      <td>롯데</td>
      <td>0.000</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>181cm/82kg</td>
      <td>1989년 02월 15일</td>
      <td>내야수(우투양타)</td>
      <td>석천초-대헌중-공주고</td>
      <td>4000만원</td>
      <td>0.000</td>
      <td>황진수2014</td>
    </tr>
  </tbody>
</table>
<p>1358 rows × 30 columns</p>
</div>




```python
# # 이제 교집합이 분류가 되었는지 확인해 보았다.

print(regular_season_intersection.shape, preseason_intersection.shape)
pd.DataFrame([regular_season_intersection['new_index'], preseason_intersection['new_index']])

'''
이름이 다르고 Nan인 부분이 굉장히 많았다.
분명 교집합으로 추출한거 같지만 실상 확인해 보니 교집합이 안되었다.
''';
```

    (1358, 30) (1358, 30)



```python
'''
그래서 다른 방법으로 시도해 보았다.
교집합을 만드는 과정부터 다시해 보았다.
'''

regular_season['new_index'] = regular_season['batter_name'] + regular_season['year'].apply(str)
preseason['new_index'] = preseason['batter_name'] + preseason['year'].apply(str)

intersection_batter = list(set(regular_season['new_index']).intersection(set(preseason['new_index'])))
print('교집합 된 선수의 수: ',len(intersection_batter))

regular_season_intersection = regular_season.loc[regular_season['new_index'].apply(lambda x : x in intersection_batter)]
regular_season_intersection = regular_season_intersection.sort_values(by='new_index').reset_index(drop=True)
preseason_intersection = preseason.loc[preseason['new_index'].apply(lambda x: x in intersection_batter)].copy()
preseason_intersection = preseason_intersection.sort_values(by='new_index').reset_index(drop=True)

print(regular_season_intersection.shape, preseason_intersection.shape)
print(sum(regular_season_intersection['new_index'] == preseason_intersection['new_index']))

'''
이유를 알아내었다.

regular_season_intersection.sort_values(by='new_index').reset_index(drop=True)
이 부분을 실행할 때 나는 다른 변수에 할당하지 않아도 변경되는줄 알았지만 다른 변수에 할당하여야 했다...
''';
```

    교집합 된 선수의 수:  1358
    (1358, 30) (1358, 30)
    1358



```python
# 상관관계 알아보기

correlation = regular_season_intersection['OPS'].corr(preseason_intersection['OPS'])
sns.scatterplot(x=regular_season_intersection['OPS'], y=preseason_intersection['OPS'])
plt.title('correlation(상관계수): '+ str(np.round(correlation, 2)), fontsize=20)
plt.xlabel('정규시즌 OPS', fontsize=12)
plt.ylabel('프리시즌 OPS', fontsize=12)

'''
scatter가 선형적인 모습을 보이지 않는 것으로 보아 상관관계는 거의 없다고 본다.
''';
```


    
![png](/assets/img/main4_files/main4_34_0.png)
    


## 정규시즌 데이터 확인


```python
'''
데이터는 위에 결측값을 채워둔 프레임을 가져와서 사용하려고 한다.
'''

display(regular_season.describe())
print(regular_season.shape)
regular_season.isna().sum()

'''
2454개의 행과 30개의 열을 가지고 있고,
선수 수는 2454명, 데이터는 1993년 부터 2018년까지 있다.
앞서 살펴본 프리시즌에 비해 데이터 양이 더 많은 것을 알 수 있다.
'''
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>year</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>OPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
      <td>2454.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>178.079462</td>
      <td>2011.614507</td>
      <td>0.235042</td>
      <td>72.535045</td>
      <td>201.514670</td>
      <td>29.912388</td>
      <td>55.988183</td>
      <td>9.863488</td>
      <td>0.957620</td>
      <td>5.504075</td>
      <td>84.279136</td>
      <td>27.788509</td>
      <td>5.290139</td>
      <td>2.335778</td>
      <td>20.943765</td>
      <td>3.424613</td>
      <td>38.596985</td>
      <td>4.603504</td>
      <td>0.340183</td>
      <td>0.303684</td>
      <td>3.676447</td>
      <td>0.643868</td>
    </tr>
    <tr>
      <th>std</th>
      <td>97.557947</td>
      <td>4.992833</td>
      <td>0.100894</td>
      <td>45.093871</td>
      <td>169.537029</td>
      <td>28.778759</td>
      <td>52.253844</td>
      <td>9.871314</td>
      <td>1.647193</td>
      <td>7.989380</td>
      <td>82.854200</td>
      <td>29.602966</td>
      <td>9.088580</td>
      <td>3.194045</td>
      <td>21.206113</td>
      <td>4.132614</td>
      <td>31.801466</td>
      <td>4.713531</td>
      <td>0.166238</td>
      <td>0.115253</td>
      <td>4.585248</td>
      <td>0.268184</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1993.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>101.250000</td>
      <td>2008.000000</td>
      <td>0.200000</td>
      <td>28.000000</td>
      <td>38.250000</td>
      <td>5.000000</td>
      <td>8.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>10.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>10.000000</td>
      <td>1.000000</td>
      <td>0.263158</td>
      <td>0.269000</td>
      <td>0.000000</td>
      <td>0.541000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>183.000000</td>
      <td>2013.000000</td>
      <td>0.253000</td>
      <td>79.000000</td>
      <td>163.000000</td>
      <td>21.000000</td>
      <td>40.000000</td>
      <td>7.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>56.000000</td>
      <td>17.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>14.000000</td>
      <td>2.000000</td>
      <td>33.000000</td>
      <td>3.000000</td>
      <td>0.358000</td>
      <td>0.328000</td>
      <td>2.000000</td>
      <td>0.686000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>265.000000</td>
      <td>2016.000000</td>
      <td>0.290000</td>
      <td>115.000000</td>
      <td>357.500000</td>
      <td>49.000000</td>
      <td>100.000000</td>
      <td>16.000000</td>
      <td>1.000000</td>
      <td>8.000000</td>
      <td>146.000000</td>
      <td>44.000000</td>
      <td>6.000000</td>
      <td>3.000000</td>
      <td>34.000000</td>
      <td>5.000000</td>
      <td>60.000000</td>
      <td>7.000000</td>
      <td>0.434946</td>
      <td>0.367000</td>
      <td>5.000000</td>
      <td>0.797000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>344.000000</td>
      <td>2018.000000</td>
      <td>1.000000</td>
      <td>144.000000</td>
      <td>600.000000</td>
      <td>135.000000</td>
      <td>201.000000</td>
      <td>47.000000</td>
      <td>17.000000</td>
      <td>53.000000</td>
      <td>377.000000</td>
      <td>146.000000</td>
      <td>84.000000</td>
      <td>21.000000</td>
      <td>108.000000</td>
      <td>27.000000</td>
      <td>161.000000</td>
      <td>24.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>30.000000</td>
      <td>4.000000</td>
    </tr>
  </tbody>
</table>
</div>


    (2454, 30)





    '\n2454개의 행과 30개의 열을 가지고 있고,\n선수 수는 2454명, 데이터는 1993년 부터 2018년까지 있다.\n앞서 살펴본 프리시즌에 비해 데이터 양이 더 많은 것을 알 수 있다.\n'




```python
regular_season.hist(figsize=(20,8))
plt.tight_layout()
plt.show()

'''
이 데이터를 살펴 보았는데, 여전히 0쪽에 가까운 부분들이 있다.
R(득점), 안타(H), 홈런(HR) 등 타자 쪽 기록이 왼쪽에 가깝다.

하지만 반대로 투수 쪽 기록인 삼진(SO)이 꽤나 높은 것으로 보인다.
안타는 적은데 삼진이나 병살이 좀 높다, 그리고 볼넷도 좀 낮은 것으로 보아
투고타저가 좀 있다고 생각한다.

하지만 원래 투고타저를 확인해 보려면 투수의 성적을 보아야 하지만 없으므로 정확하지는 않다.
또한 정확히 나눌 수 있는 지표가 따로 없기 때문에 개인의 의견에 따라 갈리는 듯 하다.
''';
```


    
![png](/assets/img/main4_files/main4_37_0.png)
    



```python
# OPS 박스 플롯 그리기

plt.figure(figsize=(20,6))
plt.subplot(1,2,1)  # 1행 2열에서 1번째 그래프
f = sns.boxplot(x='year', y='OPS', data = regular_season, showfliers=False)
f.set_title('연도별 OPS', size=20)
f.set_xticklabels(f.get_xticklabels(), rotation=90) # x라벨 90회전
plt.subplot(1,2,2)
plt.plot(regular_season.groupby('year')['OPS'].median())
plt.title('연도별 OPS 중앙값', size=20)
plt.show()

'''
박스 플롯은 대부분 비슷한 그림이다.
하지만 연도별 중앙값에서는 93년 초방부터 00년까지 데이터에서 큰 변동폭을 보인다.

93년부터 00년까지의 데이터를 추출해 확인해 보려고 한다.
''';
```

    /tmp/ipykernel_7065/3071742329.py:7: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
      f.set_xticklabels(f.get_xticklabels(), rotation=90) # x라벨 90회전



    
![png](/assets/img/main4_files/main4_38_1.png)
    



```python
'''
각 연도별 선수의 수를 확인해 보았다.

큰 변동 폭을 보였던 연도에는 역시나 선수의 수가 10명도 아닌 3명도 채 되지 않았다.
'''
pd.crosstab(regular_season['year'], 'count').T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>1993</th>
      <th>1994</th>
      <th>1995</th>
      <th>1996</th>
      <th>1997</th>
      <th>1998</th>
      <th>1999</th>
      <th>2000</th>
      <th>2001</th>
      <th>2002</th>
      <th>2003</th>
      <th>2004</th>
      <th>2005</th>
      <th>2006</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
    </tr>
    <tr>
      <th>col_0</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>7</td>
      <td>8</td>
      <td>10</td>
      <td>14</td>
      <td>20</td>
      <td>32</td>
      <td>43</td>
      <td>54</td>
      <td>68</td>
      <td>73</td>
      <td>85</td>
      <td>98</td>
      <td>115</td>
      <td>124</td>
      <td>130</td>
      <td>151</td>
      <td>174</td>
      <td>194</td>
      <td>186</td>
      <td>207</td>
      <td>213</td>
      <td>217</td>
      <td>227</td>
    </tr>
  </tbody>
</table>
</div>




```python
'''
이제 팀별 OPS를 비교해 보려고 한다.
'''

display(regular_season.pivot_table(index=['team'], columns='year', values='OPS', aggfunc='median'))


'''
몇 가지 문제가 있는데
1. 팀 명이 바뀌는 경우에는 하나로 되어있지 않고 따로 되어있다. 
    (현대 - 우리 - 히어로즈 - 넥센, OB - 두산과 같이 팀이 인수되어 변경되었지만 여기서는 반영되지 않고 다른 팀으로 분류되었다.)
2. 그러자니 창단부터 이어진 팀(삼성, 롯데)도 98년 이전에는 데이터가 없다.
3. 전신팀이 없는 경우도 있다.
    (한화 전신 빙그레, LG 전신 MBC)
    
그렇기 때문에 전신까지 모두 합쳐서 새로운 데이터프레임을 만들어볼 생각이다.
''';
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>1993</th>
      <th>1994</th>
      <th>1995</th>
      <th>1996</th>
      <th>1997</th>
      <th>1998</th>
      <th>1999</th>
      <th>2000</th>
      <th>2001</th>
      <th>2002</th>
      <th>2003</th>
      <th>2004</th>
      <th>2005</th>
      <th>2006</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
    </tr>
    <tr>
      <th>team</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KIA</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.849337</td>
      <td>0.829906</td>
      <td>0.681098</td>
      <td>0.710473</td>
      <td>0.583333</td>
      <td>0.717176</td>
      <td>0.546944</td>
      <td>0.644474</td>
      <td>0.707000</td>
      <td>0.725000</td>
      <td>0.680963</td>
      <td>0.615420</td>
      <td>0.679763</td>
      <td>0.751196</td>
      <td>0.598500</td>
      <td>0.777000</td>
      <td>0.774500</td>
      <td>0.7320</td>
    </tr>
    <tr>
      <th>KT</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.643561</td>
      <td>0.634500</td>
      <td>0.710791</td>
      <td>0.6550</td>
    </tr>
    <tr>
      <th>LG</th>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.476212</td>
      <td>0.679836</td>
      <td>0.509843</td>
      <td>0.637173</td>
      <td>0.609035</td>
      <td>0.698978</td>
      <td>0.645345</td>
      <td>0.674368</td>
      <td>0.594543</td>
      <td>0.657000</td>
      <td>0.588000</td>
      <td>0.661500</td>
      <td>0.622015</td>
      <td>0.704000</td>
      <td>0.677000</td>
      <td>0.626000</td>
      <td>0.552501</td>
      <td>0.653000</td>
      <td>0.680809</td>
      <td>0.678000</td>
      <td>0.729000</td>
      <td>0.703000</td>
      <td>0.7040</td>
    </tr>
    <tr>
      <th>NC</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.652500</td>
      <td>0.636742</td>
      <td>0.703500</td>
      <td>0.703000</td>
      <td>0.705000</td>
      <td>0.6000</td>
    </tr>
    <tr>
      <th>OB</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.615797</td>
      <td>0.727667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SK</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.596491</td>
      <td>0.000000</td>
      <td>0.636000</td>
      <td>0.494000</td>
      <td>0.601000</td>
      <td>0.682591</td>
      <td>0.723500</td>
      <td>0.693000</td>
      <td>0.822977</td>
      <td>0.689176</td>
      <td>0.710000</td>
      <td>0.666953</td>
      <td>0.689636</td>
      <td>0.751500</td>
      <td>0.714000</td>
      <td>0.798500</td>
      <td>0.764796</td>
      <td>0.7685</td>
    </tr>
    <tr>
      <th>넥센</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.636166</td>
      <td>0.623000</td>
      <td>0.589000</td>
      <td>0.671000</td>
      <td>0.792032</td>
      <td>0.753000</td>
      <td>0.800500</td>
      <td>0.743500</td>
      <td>0.7650</td>
    </tr>
    <tr>
      <th>두산</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.853830</td>
      <td>0.739755</td>
      <td>0.695808</td>
      <td>0.762809</td>
      <td>0.643209</td>
      <td>0.672643</td>
      <td>0.699575</td>
      <td>0.639750</td>
      <td>0.654608</td>
      <td>0.679000</td>
      <td>0.701938</td>
      <td>0.780000</td>
      <td>0.733000</td>
      <td>0.660000</td>
      <td>0.781500</td>
      <td>0.702330</td>
      <td>0.760000</td>
      <td>0.763000</td>
      <td>0.685000</td>
      <td>0.8230</td>
    </tr>
    <tr>
      <th>롯데</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.124961</td>
      <td>0.453390</td>
      <td>0.577847</td>
      <td>0.577000</td>
      <td>0.638655</td>
      <td>0.662041</td>
      <td>0.673000</td>
      <td>0.586748</td>
      <td>0.615000</td>
      <td>0.725455</td>
      <td>0.675000</td>
      <td>0.653000</td>
      <td>0.676715</td>
      <td>0.581845</td>
      <td>0.564000</td>
      <td>0.689000</td>
      <td>0.622000</td>
      <td>0.704000</td>
      <td>0.728000</td>
      <td>0.7100</td>
    </tr>
    <tr>
      <th>삼성</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.575549</td>
      <td>0.369048</td>
      <td>0.830124</td>
      <td>0.742000</td>
      <td>0.428000</td>
      <td>0.579137</td>
      <td>0.741419</td>
      <td>0.717275</td>
      <td>0.597875</td>
      <td>0.669774</td>
      <td>0.684000</td>
      <td>0.771000</td>
      <td>0.677606</td>
      <td>0.614071</td>
      <td>0.712500</td>
      <td>0.737000</td>
      <td>0.724000</td>
      <td>0.717500</td>
      <td>0.684000</td>
      <td>0.6515</td>
    </tr>
    <tr>
      <th>쌍방울</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>우리</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.645375</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>한화</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.890260</td>
      <td>0.768116</td>
      <td>0.456915</td>
      <td>0.512775</td>
      <td>0.478132</td>
      <td>0.870676</td>
      <td>0.741000</td>
      <td>0.719601</td>
      <td>0.677000</td>
      <td>0.577151</td>
      <td>0.624351</td>
      <td>0.665602</td>
      <td>0.560294</td>
      <td>0.672000</td>
      <td>0.628597</td>
      <td>0.649190</td>
      <td>0.583929</td>
      <td>0.615692</td>
      <td>0.717000</td>
      <td>0.673000</td>
      <td>0.653409</td>
      <td>0.675500</td>
      <td>0.6950</td>
    </tr>
    <tr>
      <th>해태</th>
      <td>0.764912</td>
      <td>1.036198</td>
      <td>0.987261</td>
      <td>0.781758</td>
      <td>0.836358</td>
      <td>0.844605</td>
      <td>0.492506</td>
      <td>0.463483</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>현대</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.833385</td>
      <td>0.783934</td>
      <td>0.547971</td>
      <td>0.794743</td>
      <td>0.838528</td>
      <td>0.828384</td>
      <td>0.673733</td>
      <td>0.819444</td>
      <td>0.716000</td>
      <td>0.721571</td>
      <td>0.677000</td>
      <td>0.613006</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>히어로즈</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.598059</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



```python
'''
전신 팀의 경우, 팀 이름은 현재 팀으로 간주한다.
ex) 해태, 기아 -> 기아
'''
team_list = set(regular_season['team']) # 팀 목록

new_team_dict = {
    '해태': 'KIA',
    'OB': '두산',
    '현대': '넥센',
    '우리': '넥센',
    '히어로즈': '넥센',
}

regular_season['team'] = regular_season['team'].map(new_team_dict).fillna(regular_season['team'])

# 피벗 테이블 만들기
regular_season_pivot = regular_season.pivot_table(index=['team'], columns='year', values='OPS', aggfunc='median')
display(regular_season_pivot)
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>1993</th>
      <th>1994</th>
      <th>1995</th>
      <th>1996</th>
      <th>1997</th>
      <th>1998</th>
      <th>1999</th>
      <th>2000</th>
      <th>2001</th>
      <th>2002</th>
      <th>2003</th>
      <th>2004</th>
      <th>2005</th>
      <th>2006</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
    </tr>
    <tr>
      <th>team</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KIA</th>
      <td>0.764912</td>
      <td>1.036198</td>
      <td>0.987261</td>
      <td>0.781758</td>
      <td>0.836358</td>
      <td>0.844605</td>
      <td>0.492506</td>
      <td>0.463483</td>
      <td>0.849337</td>
      <td>0.829906</td>
      <td>0.681098</td>
      <td>0.710473</td>
      <td>0.583333</td>
      <td>0.717176</td>
      <td>0.546944</td>
      <td>0.644474</td>
      <td>0.707000</td>
      <td>0.725000</td>
      <td>0.680963</td>
      <td>0.615420</td>
      <td>0.679763</td>
      <td>0.751196</td>
      <td>0.598500</td>
      <td>0.777000</td>
      <td>0.774500</td>
      <td>0.7320</td>
    </tr>
    <tr>
      <th>KT</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.643561</td>
      <td>0.634500</td>
      <td>0.710791</td>
      <td>0.6550</td>
    </tr>
    <tr>
      <th>LG</th>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.476212</td>
      <td>0.679836</td>
      <td>0.509843</td>
      <td>0.637173</td>
      <td>0.609035</td>
      <td>0.698978</td>
      <td>0.645345</td>
      <td>0.674368</td>
      <td>0.594543</td>
      <td>0.657000</td>
      <td>0.588000</td>
      <td>0.661500</td>
      <td>0.622015</td>
      <td>0.704000</td>
      <td>0.677000</td>
      <td>0.626000</td>
      <td>0.552501</td>
      <td>0.653000</td>
      <td>0.680809</td>
      <td>0.678000</td>
      <td>0.729000</td>
      <td>0.703000</td>
      <td>0.7040</td>
    </tr>
    <tr>
      <th>NC</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.652500</td>
      <td>0.636742</td>
      <td>0.703500</td>
      <td>0.703000</td>
      <td>0.705000</td>
      <td>0.6000</td>
    </tr>
    <tr>
      <th>SK</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.596491</td>
      <td>0.000000</td>
      <td>0.636000</td>
      <td>0.494000</td>
      <td>0.601000</td>
      <td>0.682591</td>
      <td>0.723500</td>
      <td>0.693000</td>
      <td>0.822977</td>
      <td>0.689176</td>
      <td>0.710000</td>
      <td>0.666953</td>
      <td>0.689636</td>
      <td>0.751500</td>
      <td>0.714000</td>
      <td>0.798500</td>
      <td>0.764796</td>
      <td>0.7685</td>
    </tr>
    <tr>
      <th>넥센</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.833385</td>
      <td>0.783934</td>
      <td>0.547971</td>
      <td>0.794743</td>
      <td>0.838528</td>
      <td>0.828384</td>
      <td>0.673733</td>
      <td>0.819444</td>
      <td>0.716000</td>
      <td>0.721571</td>
      <td>0.677000</td>
      <td>0.613006</td>
      <td>0.645375</td>
      <td>0.598059</td>
      <td>0.636166</td>
      <td>0.623000</td>
      <td>0.589000</td>
      <td>0.671000</td>
      <td>0.792032</td>
      <td>0.753000</td>
      <td>0.800500</td>
      <td>0.743500</td>
      <td>0.7650</td>
    </tr>
    <tr>
      <th>두산</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.615797</td>
      <td>0.727667</td>
      <td>0.853830</td>
      <td>0.739755</td>
      <td>0.695808</td>
      <td>0.762809</td>
      <td>0.643209</td>
      <td>0.672643</td>
      <td>0.699575</td>
      <td>0.639750</td>
      <td>0.654608</td>
      <td>0.679000</td>
      <td>0.701938</td>
      <td>0.780000</td>
      <td>0.733000</td>
      <td>0.660000</td>
      <td>0.781500</td>
      <td>0.702330</td>
      <td>0.760000</td>
      <td>0.763000</td>
      <td>0.685000</td>
      <td>0.8230</td>
    </tr>
    <tr>
      <th>롯데</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.124961</td>
      <td>0.453390</td>
      <td>0.577847</td>
      <td>0.577000</td>
      <td>0.638655</td>
      <td>0.662041</td>
      <td>0.673000</td>
      <td>0.586748</td>
      <td>0.615000</td>
      <td>0.725455</td>
      <td>0.675000</td>
      <td>0.653000</td>
      <td>0.676715</td>
      <td>0.581845</td>
      <td>0.564000</td>
      <td>0.689000</td>
      <td>0.622000</td>
      <td>0.704000</td>
      <td>0.728000</td>
      <td>0.7100</td>
    </tr>
    <tr>
      <th>삼성</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.575549</td>
      <td>0.369048</td>
      <td>0.830124</td>
      <td>0.742000</td>
      <td>0.428000</td>
      <td>0.579137</td>
      <td>0.741419</td>
      <td>0.717275</td>
      <td>0.597875</td>
      <td>0.669774</td>
      <td>0.684000</td>
      <td>0.771000</td>
      <td>0.677606</td>
      <td>0.614071</td>
      <td>0.712500</td>
      <td>0.737000</td>
      <td>0.724000</td>
      <td>0.717500</td>
      <td>0.684000</td>
      <td>0.6515</td>
    </tr>
    <tr>
      <th>쌍방울</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>한화</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.890260</td>
      <td>0.768116</td>
      <td>0.456915</td>
      <td>0.512775</td>
      <td>0.478132</td>
      <td>0.870676</td>
      <td>0.741000</td>
      <td>0.719601</td>
      <td>0.677000</td>
      <td>0.577151</td>
      <td>0.624351</td>
      <td>0.665602</td>
      <td>0.560294</td>
      <td>0.672000</td>
      <td>0.628597</td>
      <td>0.649190</td>
      <td>0.583929</td>
      <td>0.615692</td>
      <td>0.717000</td>
      <td>0.673000</td>
      <td>0.653409</td>
      <td>0.675500</td>
      <td>0.6950</td>
    </tr>
  </tbody>
</table>
</div>



```python
'''
비교적 최근에 창단되어 데이터가 없는 팀(NC, KT)은 데이터가 적기 때문에 제외한다.
또한 데이터가 없는 팀(쌍방울)도 제외한다.
그리고 모든 팀이  데이터가 있는 01년부터 OPS 값을 살펴보려고 한다.
'''

# 01년 이후 NaN 값이 있는 팀은 제외
team_list = regular_season_pivot.loc[:, 2001:].isna().sum(axis=1) <= 0

plt.figure(figsize=(20,9))
plt.plot(regular_season_pivot.loc[team_list, 2001:].T)
plt.legend(regular_season_pivot.loc[team_list, 2001:].T.columns, loc='center left', bbox_to_anchor=(1, 0.5))
plt.xticks(regular_season_pivot.loc[team_list, 2001:].columns)
plt.title('팀별 성적')
plt.show()

'''
하지만 위에서 봤듯이 OPS가 그나마 중앙에 모여있는 2005년 이전(사실 대부분)의 데이터의 수가 매우 적다.
''';
```


    
![png](/assets/img/main4_files/main4_42_0.png)
    


### 키와 몸무게로 분석


```python
'''
키와 몸무게 그리고 포지션에서도 결측치가 존재한다.
'''

# 결측치 확인
print(regular_season.isna().sum())
regular_season.head(2)
```

    batter_id             0
    batter_name           0
    year                  0
    team                  0
    avg                   0
    G                     0
    AB                    0
    R                     0
    H                     0
    2B                    0
    3B                    0
    HR                    0
    TB                    0
    RBI                   0
    SB                    0
    CS                    0
    BB                    0
    HBP                   0
    SO                    0
    GDP                   0
    SLG                   0
    OBP                   0
    E                     0
    height/weight       802
    year_born             0
    position            802
    career                0
    starting_salary    1067
    OPS                   0
    new_index             0
    dtype: int64





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_id</th>
      <th>batter_name</th>
      <th>year</th>
      <th>team</th>
      <th>avg</th>
      <th>G</th>
      <th>AB</th>
      <th>R</th>
      <th>H</th>
      <th>2B</th>
      <th>3B</th>
      <th>HR</th>
      <th>TB</th>
      <th>RBI</th>
      <th>SB</th>
      <th>CS</th>
      <th>BB</th>
      <th>HBP</th>
      <th>SO</th>
      <th>GDP</th>
      <th>SLG</th>
      <th>OBP</th>
      <th>E</th>
      <th>height/weight</th>
      <th>year_born</th>
      <th>position</th>
      <th>career</th>
      <th>starting_salary</th>
      <th>OPS</th>
      <th>new_index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>가르시아</td>
      <td>2018</td>
      <td>LG</td>
      <td>0.339</td>
      <td>50</td>
      <td>183</td>
      <td>27</td>
      <td>62</td>
      <td>9</td>
      <td>0</td>
      <td>8</td>
      <td>95</td>
      <td>34</td>
      <td>5</td>
      <td>0</td>
      <td>9</td>
      <td>8</td>
      <td>25</td>
      <td>3</td>
      <td>0.519</td>
      <td>0.383</td>
      <td>9</td>
      <td>177cm/93kg</td>
      <td>1985년 04월 12일</td>
      <td>내야수(우투우타)</td>
      <td>쿠바 Ciego de Avila Maximo Gomez Baez(대)</td>
      <td>NaN</td>
      <td>0.902</td>
      <td>가르시아2018</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>강경학</td>
      <td>2011</td>
      <td>한화</td>
      <td>0.000</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>180cm/72kg</td>
      <td>1992년 08월 11일</td>
      <td>내야수(우투좌타)</td>
      <td>광주대성초-광주동성중-광주동성고</td>
      <td>10000만원</td>
      <td>0.000</td>
      <td>강경학2011</td>
    </tr>
  </tbody>
</table>
</div>




```python
'''
키/몸무게/포지션을 채워주려고 한다.
선수 키/몸무게/포지션은 KBO 홈페이지에서, 그리고 우투우타, 좌투우타와 같은 경우는 위키백과에서 검색하여 가져왔다.
'''

'./batter_height_weight_position_insert.ipynb';
```


```python
def insert_batter_info(row, batter_height_weight_position):
    name = row['batter_name']
    if name in batter_height_weight_position:
        info = batter_height_weight_position[name]
        height_weight, position = info.split('/')[0] + '/' + info.split('/')[1], info.split('/')[2]
        
        row['height/weight'] = height_weight
        row['position'] = position

        # display(row[['height/weight', 'position']])
        
    return row

with open('output_data.json', 'r', encoding='utf-8') as json_file:
    data = json.load(json_file)
print(type(data))
# data

# apply를 사용하여 각 행에 대해 업데이트 적용
regular_season = regular_season.apply(insert_batter_info, axis=1, batter_height_weight_position=data)
display(regular_season[regular_season['batter_name'] == '유재혁'][['batter_name', 'height/weight', 'position']])

regular_season.isna().sum()
```

    <class 'dict'>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>batter_name</th>
      <th>height/weight</th>
      <th>position</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1337</th>
      <td>유재혁</td>
      <td>182cm/70kg</td>
      <td>외야수(우투우타)</td>
    </tr>
  </tbody>
</table>
</div>





    batter_id             0
    batter_name           0
    year                  0
    team                  0
    avg                   0
    G                     0
    AB                    0
    R                     0
    H                     0
    2B                    0
    3B                    0
    HR                    0
    TB                    0
    RBI                   0
    SB                    0
    CS                    0
    BB                    0
    HBP                   0
    SO                    0
    GDP                   0
    SLG                   0
    OBP                   0
    E                     0
    height/weight         0
    year_born             0
    position              0
    career                0
    starting_salary    1067
    OPS                   0
    new_index             0
    dtype: int64




```python
'''
키 대비 몸무게 계산
높다면 몸무게가 무거워 힘이 세고, 적으면 그만큼 가벼워 스피드가 빠를 것이라 예상
힘은 연관된 장타율과, 스피드는 연관된 출루율과 상관관계를 분석
'''

# 키와 몸무게를 분리
regular_season['height'] = regular_season['height/weight'].apply(lambda x: int(re.findall('\d+', x.split('/')[0])[0]))
regular_season['weight'] = regular_season['height/weight'].apply(lambda x: int(re.findall('\d+', x.split('/')[1])[0]))

# 키 대비 몸무게
regular_season['weight_per_height'] = regular_season['weight'] / regular_season['height']

plt.figure(figsize=(20,9))
plt.subplot(1,2,1)

obp_weight_corr = regular_season['weight_per_height'].corr(regular_season['OBP'])
slg_weight_corr = regular_season['weight_per_height'].corr(regular_season['SLG'])

sns.scatterplot(x = regular_season['weight_per_height'], y = regular_season['OBP'])
plt.title('몸무게/키 OBP 상관관계, corr: '+str(round(obp_weight_corr, 2)))
plt.ylabel('정규리그 OBP')
plt.xlabel('몸무게/키')

plt.subplot(1,2,2)
sns.scatterplot(x = regular_season['weight_per_height'], y = regular_season['SLG'])
plt.title('몸무게/키 SLG 상관관계, corr: '+str(round(slg_weight_corr, 2)))
plt.ylabel('정규리그 SLG')
plt.xlabel('몸무게/키')
plt.show()

'''
선형적인 모습이 나오지 않는 것을 보아 상관관계는 없는 것 같다.
''';
```


    
![png](/assets/img/main4_files/main4_47_0.png)
    



```python
'''
포지션, 타수별 OPS의 관계를 알아보자
'''

regular_season['position']
```




    0       내야수(우투우타)
    1       내야수(우투좌타)
    2       내야수(우투좌타)
    3       내야수(우투좌타)
    4       내야수(우투좌타)
              ...    
    2449    내야수(우투양타)
    2450    내야수(우투양타)
    2451    내야수(우투양타)
    2452    내야수(우투양타)
    2453    내야수(우투양타)
    Name: position, Length: 2454, dtype: object




```python
# 포지션, 타수 분리
regular_season['pos'] = regular_season['position'].apply(lambda x: x.split('(')[0])
regular_season['hand'] = regular_season['position'].apply(lambda x: x.split('(')[1].replace(')', ''))

regular_season[['pos', 'hand']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>hand</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>내야수</td>
      <td>우투우타</td>
    </tr>
    <tr>
      <th>1</th>
      <td>내야수</td>
      <td>우투좌타</td>
    </tr>
    <tr>
      <th>2</th>
      <td>내야수</td>
      <td>우투좌타</td>
    </tr>
    <tr>
      <th>3</th>
      <td>내야수</td>
      <td>우투좌타</td>
    </tr>
    <tr>
      <th>4</th>
      <td>내야수</td>
      <td>우투좌타</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2449</th>
      <td>내야수</td>
      <td>우투양타</td>
    </tr>
    <tr>
      <th>2450</th>
      <td>내야수</td>
      <td>우투양타</td>
    </tr>
    <tr>
      <th>2451</th>
      <td>내야수</td>
      <td>우투양타</td>
    </tr>
    <tr>
      <th>2452</th>
      <td>내야수</td>
      <td>우투양타</td>
    </tr>
    <tr>
      <th>2453</th>
      <td>내야수</td>
      <td>우투양타</td>
    </tr>
  </tbody>
</table>
<p>2454 rows × 2 columns</p>
</div>




```python
plt.figure(figsize=(20,9))
plt.subplot(1,2,1)
ax = sns.boxplot(x='pos', y='OPS', data=regular_season, showfliters = False)


```
